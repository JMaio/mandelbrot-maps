{"version":3,"sources":["common/values.ts","common/routing.ts","common/utils.ts","components/info/ChangeCoordinatesCard.tsx","components/info/CoordinatesCard.tsx","components/info/CoordinateInterface.tsx","components/info/InfoDialog.tsx","dist/clientDetect.js","shaders/newSmoothJuliaShader.js","common/settings.ts","components/settings/SettingsDefinitions.tsx","components/settings/SettingsContext.tsx","theme/theme.tsx","shaders/fullVertexShader.js","components/render/WebGLCanvas.tsx","components/render/MinimapViewer.tsx","components/render/JuliaRenderer.tsx","shaders/newSmoothMandelbrotShader.ts","components/info/FPSCard.tsx","components/render/MandelbrotRenderer.tsx","serviceWorker.js","components/ServiceWorkerWrapper.tsx","components/settings/SettingsMenu.tsx","App.tsx","index.tsx"],"names":["viewerOrigin","xy","z","theta","defaultMandelbrotStart","defaultJuliaStart","springsConfigs","default","mass","tension","friction","precision","zoom","rot","user","toFloatDisplay","n","p","toFixed","toFloatDisplayShort","NamedHashURLViewer","name","v","this","ViewerURLManager","vs","updateFromURL","asHashURL","params","currentViewerState","newV","undefined","map","toFloatDisplayDefault","m","j","updateViewer","currentLocation","window","location","hash","replace","l","viewerParams","split","filter","length","forEach","s","Number","x","y","t","error","console","log","genericTouchBind","domTarget","controls","setDragging","xyCtrl","setControlXY","zoomCtrl","minZoom","maxZoom","setControlZoom","rotCtrl","setControlRot","zoomMult","getRealZoom","current","height","handlers","onPinch","event","da","vdva","down","movement","md","ma","delta","first","origin","memo","getValue","a","o","preventDefault","newZ","_","clamp","deg","newZclamp","realZoom","vScale","subV","relMove","addV","vRotate","immediate","config","Math","PI","onWheel","my","active","shiftKey","newT","onDrag","direction","pinching","velocity","cancel","last","vecXY","eventOptions","passive","capture","warpToPoint","ChangeCoordinatesCard","props","useState","setXY","setZoom","setTheta","Card","style","width","zIndex","position","padding","display","flexDirection","flexShrink","Grid","container","alignItems","TextField","size","onChange","e","target","value","type","defaultValue","inputProps","step","label","justify","min","Button","marginTop","onClick","mandelbrot","CoordinatesCard","marginBottom","Typography","align","fontFamily","fontSize","span","interpolate","CoordinateInterface","Grow","in","show","right","top","margin","DialogTitle","withStyles","theme","createStyles","root","spacing","image","marginRight","closeButton","marginLeft","color","palette","grey","children","classes","onClose","other","disableTypography","className","src","alt","variant","IconButton","aria-label","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Alert","elevation","InfoDialog","ctrl","open","setOpen","snackBarOpen","setSnackBarOpen","handleClose","clientData","useMemo","screenSize","screen","nameOffset","verOffset","ix","nVer","navigator","appVersion","nAgt","userAgent","browser","appName","version","parseFloat","majorVersion","parseInt","indexOf","substring","lastIndexOf","toLowerCase","toUpperCase","isNaN","mobile","test","cookieEnabled","document","cookie","os","clientStrings","r","id","cs","osVersion","exec","gl","debugInfo","gpuVendor","renderer","system","device","canvas","createElement","getContext","getExtension","getParameter","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","browserVersion","browserRelease","platform","dpr","devicePixelRatio","gpu","clientDetect","Dialog","aria-labelledby","maxWidth","dividers","gutterBottom","Link","href","Divider","Box","TableContainer","component","Paper","Table","TableHead","TableRow","TableCell","colSpan","TableBody","Object","entries","k","key","String","data","clipboard","writeText","prompt","writeToClipboard","JSON","stringify","startIcon","Snackbar","autoHideDuration","severity","surveyLink","rel","textDecoration","autoFocus","newSmoothJuliaShader","maxI","AA","B","defaultSettings","showMinimap","showCrosshair","showCoordinates","showFPS","useDPR","useAA","settingsWidgets","settings","checked","control","Switch","labelPlacement","Slider","max","valueLabelDisplay","marks","SettingsContext","createContext","setSettings","SettingsProvider","Provider","createMuiTheme","MuiSwitch","MuiButton","primary","main","colors","blue","secondary","red","info","fullscreenVertexArray","numComponents","WebGLCanvas","React","forwardRef","refAny","canvasRef","useRef","renderRequestRef","bufferInfo","programInfo","u","setFps","fps","useCallback","mini","setupCanvas","debug","useEffect","addEventListener","compileShader","ctx","twgl","fragShader","then","frames","elapsedTime","render","time","prog","buff","viewport","uniforms","resolution","u_zoom","u_c","c","u_xy","u_maxI","u_theta","useProgram","program","requestAnimationFrame","cancelAnimationFrame","ref","cursor","dragging","displayName","MinimapViewer","rest","ButtonBase","left","bottom","borderRadius","boxShadow","overflow","JuliaRenderer","miniCanvasRef","miniFragShader","gtb","useGesture","Consumer","makeCrosshair","stroke","radius","standardCrosshair","miniCrosshair","newSmoothMandelbrotShader","crosshairShape","FPSCard","userSelect","div","MandelbrotRenderer","isLocalhost","Boolean","hostname","match","register","URL","process","swUrl","fetch","response","contentType","headers","get","status","serviceWorker","ready","registration","unregister","reload","registerValidSW","catch","checkValidServiceWorker","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","ServiceWorkerWrapper","showReload","setShowReload","waitingWorker","setWaitingWorker","onSWUpdate","waiting","anchorOrigin","vertical","horizontal","action","postMessage","useStyles","makeStyles","button","sliderControl","GroupDivider","GroupTitle","title","SettingsMenu","anchorEl","setAnchorEl","ResetButton","aria-controls","reset","AboutButton","toggleInfo","Fab","aria-haspopup","currentTarget","Backdrop","Popover","keepMounted","transformOrigin","paddingLeft","paddingRight","paddingTop","paddingBottom","item","widgets","getSettingsWidgetsGrouping","g","FormGroup","widget","FormControlLabel","val","prevState","App","isClient","getSize","innerWidth","innerHeight","windowSize","setWindowSize","handleResize","removeEventListener","useWindowSize","loc","setLoc","handler","to","useHashLocation","updateBrowserHash","history","replaceState","urlManager","updateHash","asFullHashURL","updateM","updateJ","mandelbrotControls","useSpring","onRest","juliaControls","showInfo","setShowInfo","ThemeProvider","xs","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.6168dc77.chunk.js","sourcesContent":["import { ViewerLocation } from './types';\n\n// this multiplier subdivides the screen space into smaller increments\n// to allow for velocity calculations to not immediately decay, due to the\n// otherwise small scale that is being mapped to the screen.\n// export const screenScaleMultiplier = 1e-7;\n// TL;DR this was a workaround - react-spring allows for \"precision\"\n//       to be defined in each spring configuration, which is:\n//       > The smallest velocity before the animation is considered \"not moving\"\nexport const defaultPrecision = 1e-7;\n\nexport const viewerOrigin: ViewerLocation = {\n  xy: [0, 0],\n  z: 1,\n  theta: 0,\n};\n\nexport const defaultMandelbrotStart: ViewerLocation = {\n  xy: [0.2361652, 0.5633767],\n  z: 4,\n  theta: 0.2,\n};\nexport const defaultJuliaStart: ViewerLocation = {\n  xy: [0.4364131, -0.6468786],\n  z: 4,\n  theta: 2.12,\n};\n\nexport const springsConfigs = {\n  /** used when the values are animated to a point, includes decay */\n  default: {\n    xy: { mass: 1, tension: 500, friction: 75, precision: defaultPrecision },\n    zoom: { mass: 1, tension: 300, friction: 40 },\n    rot: { mass: 1, tension: 400, friction: 75 },\n  },\n  /** used when a user is interacting with the view */\n  user: {\n    xy: { mass: 1, tension: 2000, friction: 75, precision: defaultPrecision },\n    zoom: { mass: 1, tension: 1200, friction: 75 },\n    rot: { mass: 1, tension: 1200, friction: 75 },\n  },\n  // default and decay are merged to give them single \"non-user\" values\n  // decay: {\n  //   /** used after the user has let go of the view, decaying */\n  //   xy: { mass: 1, tension: 500, friction: 75 },\n  //   zoom: { mass: 1, tension: 300, friction: 50 },\n  //   rot: { mass: 1, tension: 400, friction: 75 },\n  // },\n};\n\n// export const defaultSpringConfig = { mass: 1, tension: 100, friction: 200 };\n\n// export const xyCtrlSpringConfig = { mass: 1, tension: 2000, friction: 100 };\n// export const xyCtrlSpringDecayConfig = { mass: 1, tension: 500, friction: 75 };\n\n// default number of numbers after the decimal point\nexport const defaultFloatFixedPrecision = 7;\nexport const shortFloatFixedPrecision = 2;\n\nexport const toFloatDisplay = (n: number, p: number): number => +n.toFixed(p);\n\nexport const toFloatDisplayDefault = (n: number): number =>\n  toFloatDisplay(n, defaultFloatFixedPrecision);\n\nexport const toFloatDisplayShort = (n: number): number =>\n  toFloatDisplay(n, shortFloatFixedPrecision);\n","import { useCallback, useEffect, useState } from 'react';\nimport { ReactUseStateType, ViewerLocation, XYType } from './types';\nimport {\n  defaultJuliaStart,\n  defaultMandelbrotStart,\n  toFloatDisplayDefault,\n  toFloatDisplayShort,\n} from './values';\n\nexport class NamedHashURLViewer {\n  name: string;\n  v: ViewerLocation;\n\n  constructor(name: string, v: ViewerLocation) {\n    this.name = name;\n    this.v = v;\n  }\n\n  /**\n   * convert a viewer's state into a defined URL representation\n   * @param namedViewer the viewer object to be converted\n   */\n  asHashURL(): string {\n    const { xy, z, theta } = this.v;\n    return `/${this.name}@${xy[0]},${xy[1]},${z},${theta}`;\n  }\n}\n\nexport class ViewerURLManager {\n  vs: {\n    [k: string]: NamedHashURLViewer;\n  };\n\n  constructor() {\n    this.vs = {};\n    this.updateFromURL();\n  }\n\n  asFullHashURL(): string {\n    return `#${this.vs['m'].asHashURL()}${this.vs['j'].asHashURL()}`;\n  }\n\n  updateFromURL(): void {\n    const params = currentViewerState();\n    this.vs['m'] = new NamedHashURLViewer(\n      'm',\n      params['m'] || { ...defaultMandelbrotStart },\n    );\n    this.vs['j'] = new NamedHashURLViewer('j', params['j'] || { ...defaultJuliaStart });\n  }\n\n  updateViewer(name: string, v: Partial<ViewerLocation>): void {\n    // console.log('updateViewer');\n    const { xy, z, theta } = v;\n    // const [[{ xy }], [{ z }], [{ theta }]] = [xyC]\n    // const [xy] = [xyCtrl?.xy];\n    const newV = this.vs[name].v;\n    if (xy !== undefined) newV.xy = xy.map((n) => toFloatDisplayDefault(n)) as XYType;\n    if (z !== undefined) newV.z = toFloatDisplayShort(z);\n    if (theta !== undefined) newV.theta = toFloatDisplayShort(theta);\n\n    this.vs[name].v = newV;\n  }\n\n  updateFromViewer(m: Partial<ViewerLocation>, j: Partial<ViewerLocation>): void {\n    this.updateViewer('m', m);\n    this.updateViewer('j', j);\n  }\n}\n\n// returns the current hash location in a normalized form\n// (excluding the leading '#' symbol)\nexport const currentLocation = (): string => {\n  // console.log(window.location);\n  const l = window.location.hash.replace('#', '') || '';\n  return l;\n};\n\nexport const currentViewerState = (): { [k: string]: ViewerLocation } => {\n  const l = currentLocation();\n  const viewerParams: { [k: string]: ViewerLocation } = {};\n  try {\n    const qs = l.split('/').filter((v) => v.length > 0);\n    qs.forEach((s) => {\n      const [v, params] = s.split('@');\n      const [x, y, z, t] = params.split(',').map(Number);\n      viewerParams[v] = { xy: [x, y] as XYType, z: z, theta: t };\n    });\n  } catch (error) {\n    console.log(error);\n  }\n  return viewerParams;\n};\n\n// non-reloading hash change\nexport const useHashNavigator = (): ((to: string) => void) =>\n  useCallback((to) => window.history.replaceState(null, document.title, to), []);\n\n// https://github.com/molefrog/wouter#customizing-the-location-hook\nexport const useHashLocation = (): ReactUseStateType<string> => {\n  const [loc, setLoc] = useState(currentLocation());\n\n  useEffect(() => {\n    // this function is called whenever the hash changes\n    const handler = () => setLoc(currentLocation());\n\n    // subscribe to hash changes\n    window.addEventListener('hashchange', handler);\n    return () => window.removeEventListener('hashchange', handler);\n  }, []);\n\n  // remember to wrap your function with `useCallback` hook\n  // a tiny but important optimization\n  const navigate = useCallback((to) => (window.location.hash = to), []);\n\n  return [loc, navigate];\n};\n","import _ from 'lodash';\r\nimport { RefObject, useCallback, useEffect, useState } from 'react';\r\nimport { addV, subV } from 'react-use-gesture';\r\nimport {\r\n  FullGestureState,\r\n  Handlers,\r\n  StateKey,\r\n  UseGestureConfig,\r\n  Vector2,\r\n} from 'react-use-gesture/dist/types';\r\nimport { Vector, vRotate, vScale } from 'vec-la-fp';\r\nimport { ViewerControlSprings, ViewerLocation } from './types';\r\nimport { springsConfigs } from './values';\r\n\r\n// https://usehooks.com/useWindowSize/\r\nexport function useWindowSize(): { width?: number; height?: number } {\r\n  const isClient = typeof window === 'object';\r\n\r\n  const getSize = useCallback(\r\n    () => ({\r\n      width: isClient ? window.innerWidth : undefined,\r\n      height: isClient ? window.innerHeight : undefined,\r\n    }),\r\n    [isClient],\r\n  );\r\n\r\n  const [windowSize, setWindowSize] = useState(getSize);\r\n\r\n  useEffect(() => {\r\n    if (!isClient) {\r\n      // return false;\r\n      return () => {\r\n        // do nothing\r\n      };\r\n    }\r\n\r\n    function handleResize() {\r\n      setWindowSize(getSize());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, [getSize, isClient]); // Empty array ensures that effect is only run on mount and unmount\r\n\r\n  return windowSize;\r\n}\r\n\r\nexport interface GenericTouchBindParams {\r\n  domTarget: RefObject<HTMLCanvasElement>;\r\n  controls: ViewerControlSprings;\r\n  // screenScaleMultiplier: number;\r\n  // gl: any,\r\n  setDragging: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nexport interface GenericTouchBindReturn {\r\n  handlers: Handlers;\r\n  config: UseGestureConfig;\r\n}\r\n\r\n// --------------------------------------------------------------------------\r\n// https://gist.github.com/evdokimovm/0e7163faf7c8fe24e41e6b68461e4feb\r\n// Convert from degrees to radians.\r\nconst degToRad = (deg: number): number => (deg * Math.PI) / 180;\r\n// Math.radians(90); // 1.5707963267948966\r\n\r\n// Convert from radians to degrees.\r\n// eslint-disable-next-line\r\nconst radToDeg = (rad: number): number => (rad * 180) / Math.PI;\r\n// Math.degrees(3.141592653589793); // 180\r\n// --------------------------------------------------------------------------\r\n\r\n// a touchbind for re-using across renderers\r\nexport function genericTouchBind({\r\n  domTarget,\r\n  controls,\r\n  setDragging,\r\n}: GenericTouchBindParams): GenericTouchBindReturn {\r\n  const [{ xy }, setControlXY] = controls.xyCtrl;\r\n  const [{ z, minZoom, maxZoom }, setControlZoom] = controls.zoomCtrl;\r\n  const [{ theta }, setControlRot] = controls.rotCtrl;\r\n\r\n  const zoomMult = { in: 3e-3, out: 1e-3 };\r\n\r\n  // used to have screenScaleMultiplier here\r\n  const getRealZoom = (z: number) => (domTarget.current?.height || 100) * z;\r\n  // * screenScaleMultiplier;\r\n\r\n  return {\r\n    handlers: {\r\n      // prevent some browser events such as swipe-based navigation or\r\n      // pinch-based zoom and instead redirect them to this handler\r\n      // onDragStart: ({ event }: FullGestureState<StateKey<'drag'>>) =>\r\n      //   event?.preventDefault(),\r\n      // onPinchStart: ({ event }: FullGestureState<StateKey<'pinch'>>) =>\r\n      //   event?.preventDefault(),\r\n      // onWheelStart: ({ event }: FullGestureState<StateKey<'wheel'>>) =>\r\n      //   event?.preventDefault(),\r\n\r\n      onPinch: ({\r\n        event,\r\n        da: [d, a],\r\n        vdva: [vd, va],\r\n        down,\r\n        // delta: [dd, da],\r\n        movement: [md, ma],\r\n        delta: [dd, da],\r\n        first,\r\n        // initial, // initial [d, a]\r\n        origin,\r\n        // movement, //: [mx, my],\r\n        memo = {\r\n          xy: xy.getValue(),\r\n          z: z.getValue(),\r\n          t: theta.getValue(),\r\n          a: 0,\r\n          o: [0, 0] as Vector2,\r\n        },\r\n      }: FullGestureState<StateKey<'pinch'>>) => {\r\n        // disable native browser events\r\n        event && event.preventDefault();\r\n\r\n        if (first) {\r\n          // remember the angle, location at which the pinch gesture starts\r\n          // memo.a = a;\r\n          memo.o = origin;\r\n        }\r\n\r\n        // console.log(subV(origin, initial));\r\n        // console.log(initial);\r\n        // console.log(origin);\r\n        // console.log(md);\r\n        // console.log(ma);\r\n        // const zd = md * 1e-2;\r\n\r\n        // new zoom is the product of initial zoom and a function of the delta since the pinch\r\n        //   (initial zoom) exponentially changed by md, with linear and exponential multipliers\r\n        //     linear multiplier:\r\n        //     exponential multiplier: scale faster as pinch becomes more distant\r\n        //     if decreasing, scale must decrease more slowly\r\n        // const em = 1.33;\r\n        // const newZ =\r\n        //   memo.z * (1 + Math.sign(md) * 1e-2 * Math.abs(md) ** (md <= 0 ? 1 / em : em)); //(1 - zdelta * Math.abs(zdelta));\r\n        const newZ = _.clamp(memo.z + md * 1e-2, 0.5, 100_000) ** (1 + md * 1e-3); //(1 - zdelta * Math.abs(zdelta));\r\n        // console.log(Math.abs(md * 1e-2));\r\n        // console.log(\r\n        //   md.toFixed(2) + ' => ' + 1e-2 * Math.abs(md) ** (md <= 0 ? 0.8 : 1.1),\r\n        // );\r\n        console.log(newZ);\r\n        const newZclamp = _.clamp(newZ, minZoom.getValue(), maxZoom.getValue());\r\n\r\n        const realZoom = getRealZoom(newZclamp);\r\n\r\n        // get movement of pointer origin for panning\r\n        const [px, py]: Vector2 = vScale(-2 / realZoom, subV(origin, memo.o));\r\n        const relMove: Vector2 = [px, -py];\r\n\r\n        setControlXY({\r\n          xy: addV(memo.xy, vRotate(theta.getValue(), relMove)),\r\n          immediate: false,\r\n        });\r\n\r\n        setControlZoom({\r\n          z: newZclamp,\r\n          immediate: false,\r\n          config: down ? springsConfigs.user.zoom : springsConfigs.default.zoom,\r\n        });\r\n\r\n        setControlRot({\r\n          theta: memo.t + degToRad(ma),\r\n          // fixes issues with wrapping around from (0) to (-2pi)\r\n          immediate: false,\r\n          config: down ? springsConfigs.user.rot : springsConfigs.default.rot,\r\n        });\r\n\r\n        return memo;\r\n      },\r\n\r\n      onWheel: ({\r\n        event,\r\n        movement: [, my],\r\n        active,\r\n        shiftKey,\r\n        memo = { zoom: z.getValue(), t: theta.getValue() },\r\n      }: FullGestureState<StateKey<'wheel'>>) => {\r\n        // disable native browser events\r\n        event && event.preventDefault();\r\n\r\n        if (shiftKey) {\r\n          // if shift is pressed, rotate instead of zoom\r\n          const newT = memo.t + my * 1.5e-3;\r\n\r\n          setControlRot({\r\n            theta: newT,\r\n            config: active ? springsConfigs.user.rot : springsConfigs.default.rot,\r\n            immediate: false,\r\n          });\r\n        } else {\r\n          // set different multipliers based on zoom direction\r\n          // mouse movement negative = move up the page = zoom in\r\n          //                                   zoom        in           out\r\n          const newZ = memo.zoom * (1 - my * (my < 0 ? zoomMult.in : zoomMult.out));\r\n\r\n          setControlZoom({\r\n            z: _.clamp(newZ, minZoom.getValue(), maxZoom.getValue()),\r\n            config: active ? springsConfigs.user.zoom : springsConfigs.default.zoom,\r\n            // reset immediate value from warp function\r\n            immediate: false,\r\n          });\r\n        }\r\n        return memo;\r\n      },\r\n\r\n      onDrag: ({\r\n        event,\r\n        down,\r\n        movement,\r\n        direction: [dx, dy],\r\n        velocity,\r\n        pinching,\r\n        last,\r\n        cancel,\r\n        memo = { xy: xy.getValue(), theta: theta.getValue() },\r\n      }: FullGestureState<StateKey<'drag'>>) => {\r\n        // disable native browser events\r\n        event && event.preventDefault();\r\n\r\n        // let pinch handle movement\r\n        if (pinching) cancel && cancel();\r\n        // change according to this formula:\r\n        // move (x, y) in the opposite direction of drag (pan with cursor)\r\n        // divide by canvas size to scale appropriately\r\n        // multiply by 2 to correct scaling on viewport (?)\r\n        // use screen multiplier for more granularity\r\n        const realZoom = getRealZoom(z.getValue());\r\n\r\n        const [px, py]: Vector = vScale(-2 / realZoom, movement);\r\n        // const relMove: Vector = vScale(2 / realZoom, movement);\r\n\r\n        const relMove: Vector = [px, -py];\r\n        // const relDir: Vector = [dx, -dy];\r\n\r\n        const t = theta.getValue();\r\n\r\n        const vecXY = addV(memo.xy, vRotate(t, relMove)); // add the displacement to the starting position\r\n        // const velXY = vScale(velocity, vNorm(vecXY))\r\n\r\n        setControlXY({\r\n          // add to the current position the relative displacement (relMove), rotated by theta,\r\n          // to maintain the correct displacement direction (without this it would move as if theta=0)\r\n          xy: vecXY,\r\n          // immediate: down, // immediately apply if the gesture is active\r\n          config: down ? springsConfigs.user.xy : springsConfigs.default.xy,\r\n          // reset immediate value from warp function\r\n          immediate: false,\r\n          //  {\r\n          //   // velocity also needs to be rotated according to theta\r\n          //   // -@ts-expect-error - velocity should be `[number, number]`, but only `number` allowed\r\n          //   // velocity: vScale(-velocity / realZoom, vRotate(t, relDir)), // set the velocity (gesture momentum)\r\n          //   // velocity: vMag(vScale(-velocity / realZoom, vRotate(t, relDir))), // set the velocity (gesture momentum)\r\n          //   // velocity: velocity / screenScaleMultiplier, // set the velocity (gesture momentum)\r\n          //   // mass: down ? 1 : 5,\r\n          //   ...xyCtrlSpringConfig,\r\n          //   tension: down ? xyCtrlSpringConfig.tension : xyCtrlSpringConfig.tension / 2,\r\n          //   // -@ts-expect-error - decay is undocumented?\r\n          //   // decay: true,\r\n          // },\r\n        });\r\n\r\n        // tell the renderer that it's being dragged on\r\n        setDragging(down);\r\n\r\n        return memo;\r\n      },\r\n    },\r\n    config: {\r\n      eventOptions: { passive: false, capture: false },\r\n      domTarget: domTarget,\r\n      // The config object passed to useGesture has drag, wheel, scroll, pinch and move keys\r\n      // for specific gesture options. See here for more details.\r\n      // drag: {\r\n      //   bounds,\r\n      //   rubberband: true,\r\n      // }\r\n    },\r\n  };\r\n}\r\n\r\n/**\r\n * Warps the given controller to a desired viewer location.\r\n * @param controls The controller to be animated\r\n * @param location The (partial) viewer location to warp to: xy, zoom, theta\r\n * @param immediate Should the update happen immediately? (Useful for testing)\r\n */\r\nexport const warpToPoint = (\r\n  controls: ViewerControlSprings,\r\n  { xy, z, theta }: Partial<ViewerLocation>,\r\n  immediate = false,\r\n): void => {\r\n  // can't do a simple \"if (x)\" check since values could be zero (evaluates to \"false\")\r\n  if (xy !== undefined) {\r\n    controls.xyCtrl[1]({\r\n      // use screen scale multiplier for a simpler API\r\n      xy: xy,\r\n      config: springsConfigs.default.xy,\r\n      immediate: immediate,\r\n    });\r\n  }\r\n  if (z !== undefined) {\r\n    controls.zoomCtrl[1]({\r\n      z: z,\r\n      config: springsConfigs.default.zoom,\r\n      immediate: immediate,\r\n    });\r\n  }\r\n  if (theta !== undefined) {\r\n    controls.rotCtrl[1]({\r\n      theta: theta,\r\n      config: springsConfigs.default.rot,\r\n      immediate: immediate,\r\n    });\r\n  }\r\n};\r\n\r\n// no longer using screenScaleMultiplier\r\n// export const screenToReal = (x: number): number => x * screenScaleMultiplier;\r\n// export const RealToScreen = (x: number): number => x / screenScaleMultiplier;\r\n","import { Button, Card, Grid, TextField } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport { ChangeCoordinatesCardProps } from '../../common/info';\nimport { warpToPoint } from '../../common/utils';\nimport { defaultMandelbrotStart } from '../../common/values';\n\nconst ChangeCoordinatesCard = (props: ChangeCoordinatesCardProps): JSX.Element => {\n  const [xy, setXY] = useState(defaultMandelbrotStart.xy);\n  const [x, y] = xy;\n  const [zoom, setZoom] = useState(defaultMandelbrotStart.z);\n  const [theta, setTheta] = useState(defaultMandelbrotStart.theta);\n\n  return (\n    <Card\n      style={{\n        width: 'auto',\n        zIndex: 1300,\n        position: 'relative',\n        padding: 8,\n        display: 'flex',\n        flexDirection: 'column',\n        flexShrink: 1,\n        // borderRadius: 100,\n      }}\n    >\n      <Grid container direction=\"column\" alignItems=\"center\">\n        <TextField\n          size=\"small\"\n          style={{ width: '12ch' }}\n          onChange={(e) => setXY(([x, y]) => [Number(e.target.value), y])}\n          type=\"number\"\n          defaultValue={x}\n          inputProps={{ step: 0.01 }}\n          label=\"x\"\n        />\n        <TextField\n          size=\"small\"\n          style={{ width: '12ch' }}\n          onChange={(e) => setXY(([x, y]) => [x, Number(e.target.value)])}\n          type=\"number\"\n          defaultValue={y}\n          inputProps={{ step: 0.01 }}\n          label=\"y\"\n        />\n        <Grid container direction=\"row\" justify=\"space-around\">\n          <TextField\n            size=\"small\"\n            style={{ width: '5ch' }}\n            onChange={(e) => setZoom(Number(e.target.value))}\n            type=\"number\"\n            defaultValue={zoom}\n            inputProps={{ min: 0 }}\n            label=\"zoom\"\n          />\n          <TextField\n            size=\"small\"\n            style={{ width: '5ch' }}\n            onChange={(e) => setTheta(Number(e.target.value))}\n            type=\"number\"\n            defaultValue={theta}\n            inputProps={{ step: 0.1 }}\n            label=\"theta\"\n          />\n        </Grid>\n        <Button\n          style={{ marginTop: 12 }}\n          onClick={() => warpToPoint(props.mandelbrot, { xy: xy, z: zoom, theta: theta })}\n        >\n          Go\n        </Button>\n      </Grid>\n    </Card>\n  );\n};\n\nexport default ChangeCoordinatesCard;\n","import { Card, Typography } from '@material-ui/core';\nimport React from 'react';\nimport { animated } from 'react-spring';\nimport { CoordinatesCardProps } from '../../common/info';\nimport {\n  defaultFloatFixedPrecision,\n  shortFloatFixedPrecision,\n} from '../../common/values';\n\nconst CoordinatesCard = (props: CoordinatesCardProps): JSX.Element => {\n  return (\n    <Card\n      style={{\n        width: 'auto',\n        zIndex: 1300,\n        position: 'relative',\n        padding: '6px 12px',\n        marginBottom: 8,\n        // borderRadius: 100,\n      }}\n    >\n      <Typography align=\"right\" style={{ fontFamily: 'monospace', fontSize: '1.2rem' }}>\n        {/* https://www.typescriptlang.org/docs/handbook/basic-types.html#tuple */}\n        {/* https://www.typescriptlang.org/docs/handbook/2/objects.html#tuple-types */}\n        <animated.span>\n          {props.mandelbrot.xy.interpolate(\n            // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n            (x, y) => `${x.toFixed(defaultFloatFixedPrecision)} : x`,\n          )}\n        </animated.span>\n        <br />\n        <animated.span>\n          {props.mandelbrot.xy.interpolate(\n            // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n            (x, y) => `${y.toFixed(defaultFloatFixedPrecision)} : y`,\n          )}\n        </animated.span>\n        <br />\n        <animated.span>\n          {props.mandelbrot.zoom.interpolate(\n            (z) => `${z.toFixed(shortFloatFixedPrecision)} : z`,\n          )}\n        </animated.span>\n        <br />\n        <animated.span>\n          {props.mandelbrot.theta.interpolate(\n            (t) => `${t.toFixed(shortFloatFixedPrecision)} : t`,\n          )}\n        </animated.span>\n      </Typography>\n    </Card>\n  );\n};\n\nexport default CoordinatesCard;\n\n// <Card\n//   style={{\n//     width: 'auto',\n//     position: 'absolute',\n//     zIndex: 2,\n//     right: 0,\n//     top: 0,\n//     margin: 20,\n//     padding: 8,\n//     display: settings.coords[0] ? 'block' : 'none',\n//     // borderRadius: 100,\n//   }}\n// >\n//   <Typography align=\"right\">\n//     {/* https://www.typescriptlang.org/docs/handbook/basic-types.html#tuple */}\n//     {/* https://www.typescriptlang.org/docs/handbook/2/objects.html#tuple-types */}\n//     <animated.span>\n//       {mandelbrotControls.xyCtrl[0].xy.interpolate(\n//         // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n//         (x, y) => `${(x * screenScaleMultiplier).toFixed(7)} : x`,\n//       )}\n//     </animated.span>\n//     <br />\n//     <animated.span>\n//       {mandelbrotControls.xyCtrl[0].xy.interpolate(\n//         // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n//         (x, y) => `${(y * screenScaleMultiplier).toFixed(7)} : y`,\n//       )}\n//     </animated.span>\n//   </Typography>\n// </Card>;\n","import { Grow } from '@material-ui/core';\nimport React from 'react';\nimport { ViewerControlSprings } from '../../common/types';\nimport ChangeCoordinatesCard from './ChangeCoordinatesCard';\nimport CoordinatesCard from './CoordinatesCard';\n\nexport const CoordinateInterface = (props: {\n  mandelbrot: ViewerControlSprings;\n  show: boolean;\n}): JSX.Element => {\n  return (\n    <Grow\n      in={props.show}\n      style={{\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        margin: 20,\n        width: 'auto',\n        zIndex: 1,\n      }}\n    >\n      <div>\n        <CoordinatesCard\n          mandelbrot={{\n            xy: props.mandelbrot.xyCtrl[0].xy,\n            zoom: props.mandelbrot.zoomCtrl[0].z,\n            theta: props.mandelbrot.rotCtrl[0].theta,\n          }}\n        />\n        <ChangeCoordinatesCard mandelbrot={props.mandelbrot} />\n      </div>\n    </Grow>\n  );\n};\n\nexport default CoordinateInterface;\n","import React, { PropsWithChildren, useMemo, useState } from 'react';\r\nimport { createStyles, Theme, WithStyles, withStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {\r\n  Link,\r\n  TableContainer,\r\n  Table,\r\n  Paper,\r\n  TableRow,\r\n  TableCell,\r\n  TableHead,\r\n  TableBody,\r\n  Box,\r\n  Divider,\r\n  Snackbar,\r\n} from '@material-ui/core';\r\nimport LaunchIcon from '@material-ui/icons/Launch';\r\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\r\nimport MuiAlert, { AlertProps } from '@material-ui/lab/Alert';\r\nimport { surveyLink } from '../surveyLink.json';\r\n\r\n// for evaluating build time\r\nimport preval from 'preval.macro';\r\nimport clientDetect from '../../dist/clientDetect';\r\n\r\nconst dateTimeStamp = preval`module.exports = new Date();`;\r\n\r\nconst styles = (theme: Theme) =>\r\n  createStyles({\r\n    root: {\r\n      margin: 0,\r\n      padding: theme.spacing(2),\r\n      display: 'flex',\r\n      flexDirection: 'row',\r\n      // align: \"middle\",\r\n    },\r\n    image: {\r\n      marginTop: 'auto',\r\n      marginBottom: 'auto',\r\n      marginRight: 8,\r\n      height: 50,\r\n    },\r\n    closeButton: {\r\n      // position: 'absolute',\r\n      // right: theme.spacing(1),\r\n      // top: theme.spacing(1),\r\n      marginLeft: 'auto',\r\n      color: theme.palette.grey[500],\r\n    },\r\n  });\r\n\r\nexport interface DialogTitleProps extends PropsWithChildren<WithStyles<typeof styles>> {\r\n  onClose: () => void;\r\n  id: string;\r\n}\r\n\r\n// https://material-ui.com/guides/typescript/#usage-of-withstyles\r\nconst DialogTitle = withStyles(styles)(\r\n  ({ children, classes, onClose, ...other }: DialogTitleProps) => {\r\n    return (\r\n      <MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n        <img src=\"logo-512.png\" alt=\"Mandelbrot Maps logo\" className={classes.image} />\r\n        <Typography\r\n          variant=\"h1\"\r\n          style={{ fontSize: 24, marginTop: 'auto', marginBottom: 'auto' }}\r\n        >\r\n          {children}\r\n        </Typography>\r\n        {onClose ? (\r\n          <IconButton\r\n            aria-label=\"close\"\r\n            className={classes.closeButton}\r\n            onClick={onClose}\r\n          >\r\n            <CloseIcon />\r\n          </IconButton>\r\n        ) : null}\r\n      </MuiDialogTitle>\r\n    );\r\n  },\r\n);\r\n\r\nconst DialogContent = withStyles((theme) => ({\r\n  root: {\r\n    padding: theme.spacing(3),\r\n  },\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles((theme) => ({\r\n  root: {\r\n    margin: 0,\r\n    padding: theme.spacing(1),\r\n  },\r\n}))(MuiDialogActions);\r\n\r\nfunction Alert(props: AlertProps) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nexport default function InfoDialog(props: any): JSX.Element {\r\n  const [open, setOpen] = props.ctrl;\r\n  const [snackBarOpen, setSnackBarOpen] = useState(false);\r\n\r\n  const handleClose = () => setOpen(false);\r\n  // const showSnackBar = () => {\r\n  // new Promise(() => {\r\n  // setSnackBarOpen(false);\r\n  // }).then(() => {\r\n  // setSnackBarOpen(true);\r\n  // });\r\n  // };\r\n\r\n  // guard against null / undefined window\r\n  const clientData = useMemo(() => clientDetect(window), []);\r\n  // const clientData = window.jscd || {};\r\n\r\n  const writeToClipboard = (data: string) => {\r\n    console.log(snackBarOpen);\r\n    try {\r\n      navigator.clipboard.writeText(data);\r\n      setSnackBarOpen(true);\r\n    } catch (e) {\r\n      window.prompt('Auto copy to clipboard failed, copy manually from below:', data);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog\r\n      onClose={handleClose}\r\n      aria-labelledby=\"customized-dialog-title\"\r\n      open={open}\r\n      maxWidth=\"md\"\r\n    >\r\n      {/* <div style={{ maxWidth: 700 }}> */}\r\n      <DialogTitle id=\"customized-dialog-title\" onClose={handleClose}>\r\n        Mandelbrot Maps\r\n      </DialogTitle>\r\n      <DialogContent dividers style={{ maxWidth: 700 }}>\r\n        <Typography gutterBottom>\r\n          Mandelbrot Maps is an interactive fractal explorer built using React and WebGL.\r\n        </Typography>\r\n        <Typography gutterBottom>\r\n          Developed by{' '}\r\n          <Link href=\"https://jmaio.github.io/\" target=\"_blank\">\r\n            Joao Maio\r\n          </Link>{' '}\r\n          in 2019/2020 as part of an Honours Project at The University of Edinburgh, under\r\n          the supervision of Philip Wadler.\r\n        </Typography>\r\n        <Typography gutterBottom>\r\n          The project was simultaneously undertaken by Freddie Bawden, also under the\r\n          supervision of Philip Wadler. Freddie's version of the project is available at:{' '}\r\n          <Link href=\"http://mmaps.freddiejbawden.com/\" target=\"_blank\">\r\n            mmaps.freddiejbawden.com\r\n          </Link>\r\n        </Typography>\r\n        <Typography gutterBottom>\r\n          The{' '}\r\n          <Link\r\n            href=\"https://homepages.inf.ed.ac.uk/wadler/mandelbrot-maps/index.html\"\r\n            target=\"_blank\"\r\n          >\r\n            original Mandelbrot Maps project\r\n          </Link>{' '}\r\n          was developed by Iain Parris in 2008 as a Java Applet.\r\n        </Typography>\r\n        <Typography gutterBottom>\r\n          Mandelbrot set shader code adapted from{' '}\r\n          <Link href=\"https://www.shadertoy.com/view/4df3Rn\">Mandelbrot - smooth</Link> by{' '}\r\n          <Link href=\"http://iquilezles.org/\" target=\"_blank\">\r\n            Inigo Quilez\r\n          </Link>\r\n          .\r\n        </Typography>\r\n        {/* <Typography>\r\n            &copy; Joao Maio 2020\r\n          </Typography> */}\r\n\r\n        <Divider style={{ marginTop: 30, marginBottom: 30 }} />\r\n\r\n        <Box style={{ display: 'flex' }}>\r\n          <TableContainer\r\n            component={Paper}\r\n            style={{ width: 'auto', margin: 'auto', maxWidth: 460 }}\r\n          >\r\n            <Table size=\"small\" aria-label=\"a dense table\">\r\n              <TableHead>\r\n                <TableRow>\r\n                  <TableCell align=\"center\" colSpan={2} variant=\"head\">\r\n                    Device properties\r\n                  </TableCell>\r\n                </TableRow>\r\n              </TableHead>\r\n              <TableBody>\r\n                {Object.entries(clientData).map(([k, v]) => (\r\n                  <TableRow key={k}>\r\n                    <TableCell>{k}</TableCell>\r\n                    <TableCell align=\"right\" style={{ fontFamily: 'monospace' }}>\r\n                      {String(v)}\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </TableContainer>\r\n        </Box>\r\n\r\n        <Divider style={{ marginTop: 30, marginBottom: 30 }} />\r\n\r\n        <Box style={{ display: 'flex' }}>\r\n          <Typography variant=\"overline\" align=\"center\" style={{ margin: 'auto' }}>\r\n            Build:\r\n            <Typography style={{ fontFamily: 'monospace' }}>{dateTimeStamp}</Typography>\r\n            {/* {console.log(new Date(dateTimeStamp).toLocaleString('en-GB', { timeZone: 'UTC' }))} */}\r\n          </Typography>\r\n        </Box>\r\n      </DialogContent>\r\n\r\n      <DialogActions>\r\n        <Button\r\n          onClick={() => {\r\n            writeToClipboard(JSON.stringify(clientData));\r\n          }}\r\n          color=\"primary\"\r\n          variant=\"outlined\"\r\n          startIcon={<FileCopyIcon />}\r\n        >\r\n          Copy\r\n        </Button>\r\n        <Snackbar\r\n          open={snackBarOpen}\r\n          autoHideDuration={5000}\r\n          // onClose={() => setSnackBarOpen(false)}\r\n        >\r\n          <Alert onClose={() => setSnackBarOpen(false)} severity=\"info\">\r\n            Device properties copied!\r\n          </Alert>\r\n        </Snackbar>\r\n        <Link\r\n          href={surveyLink}\r\n          target=\"_blank\"\r\n          rel=\"noopener\"\r\n          style={{ textDecoration: 'none' }}\r\n        >\r\n          <Button autoFocus color=\"primary\" variant=\"outlined\" startIcon={<LaunchIcon />}>\r\n            Feedback\r\n          </Button>\r\n        </Link>\r\n      </DialogActions>\r\n      {/* </div> */}\r\n    </Dialog>\r\n  );\r\n}\r\n","/* eslint-disable */\r\n/**\r\n * JavaScript Client Detection\r\n * (C) viazenetti GmbH (Christian Ludwig)\r\n */\r\nexport default function clientDetect(window) {\r\n  var unknown = '-';\r\n\r\n  // screen\r\n  var screenSize = '';\r\n  if (window.screen.width) {\r\n    var width = window.screen.width ? window.screen.width : '';\r\n    var height = window.screen.height ? window.screen.height : '';\r\n    screenSize += '' + width + ' x ' + height;\r\n  }\r\n\r\n  // browser\r\n  var nVer = navigator.appVersion;\r\n  var nAgt = navigator.userAgent;\r\n  var browser = navigator.appName;\r\n  var version = '' + parseFloat(navigator.appVersion);\r\n  var majorVersion = parseInt(navigator.appVersion, 10);\r\n  var nameOffset, verOffset, ix;\r\n\r\n  // Opera\r\n  if ((verOffset = nAgt.indexOf('Opera')) != -1) {\r\n    browser = 'Opera';\r\n    version = nAgt.substring(verOffset + 6);\r\n    if ((verOffset = nAgt.indexOf('Version')) != -1) {\r\n      version = nAgt.substring(verOffset + 8);\r\n    }\r\n  }\r\n  // Opera Next\r\n  if ((verOffset = nAgt.indexOf('OPR')) != -1) {\r\n    browser = 'Opera';\r\n    version = nAgt.substring(verOffset + 4);\r\n  }\r\n  // Edge\r\n  else if ((verOffset = nAgt.indexOf('Edge')) != -1) {\r\n    browser = 'Microsoft Edge';\r\n    version = nAgt.substring(verOffset + 5);\r\n  }\r\n  // MSIE\r\n  else if ((verOffset = nAgt.indexOf('MSIE')) != -1) {\r\n    browser = 'Microsoft Internet Explorer';\r\n    version = nAgt.substring(verOffset + 5);\r\n  }\r\n  // Chrome\r\n  else if ((verOffset = nAgt.indexOf('Chrome')) != -1) {\r\n    browser = 'Chrome';\r\n    version = nAgt.substring(verOffset + 7);\r\n  }\r\n  // Safari\r\n  else if ((verOffset = nAgt.indexOf('Safari')) != -1) {\r\n    browser = 'Safari';\r\n    version = nAgt.substring(verOffset + 7);\r\n    if ((verOffset = nAgt.indexOf('Version')) != -1) {\r\n      version = nAgt.substring(verOffset + 8);\r\n    }\r\n  }\r\n  // Firefox\r\n  else if ((verOffset = nAgt.indexOf('Firefox')) != -1) {\r\n    browser = 'Firefox';\r\n    version = nAgt.substring(verOffset + 8);\r\n  }\r\n  // MSIE 11+\r\n  else if (nAgt.indexOf('Trident/') != -1) {\r\n    browser = 'Microsoft Internet Explorer';\r\n    version = nAgt.substring(nAgt.indexOf('rv:') + 3);\r\n  }\r\n  // Other browsers\r\n  else if (\r\n    (nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))\r\n  ) {\r\n    browser = nAgt.substring(nameOffset, verOffset);\r\n    version = nAgt.substring(verOffset + 1);\r\n    if (browser.toLowerCase() == browser.toUpperCase()) {\r\n      browser = navigator.appName;\r\n    }\r\n  }\r\n  // trim the version string\r\n  if ((ix = version.indexOf(';')) != -1) version = version.substring(0, ix);\r\n  if ((ix = version.indexOf(' ')) != -1) version = version.substring(0, ix);\r\n  if ((ix = version.indexOf(')')) != -1) version = version.substring(0, ix);\r\n\r\n  majorVersion = parseInt('' + version, 10);\r\n  if (isNaN(majorVersion)) {\r\n    version = '' + parseFloat(navigator.appVersion);\r\n    majorVersion = parseInt(navigator.appVersion, 10);\r\n  }\r\n\r\n  // mobile version\r\n  var mobile = /Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);\r\n\r\n  // cookie\r\n  var cookieEnabled = navigator.cookieEnabled ? true : false;\r\n\r\n  if (typeof navigator.cookieEnabled == 'undefined' && !cookieEnabled) {\r\n    document.cookie = 'testcookie';\r\n    cookieEnabled = document.cookie.indexOf('testcookie') != -1 ? true : false;\r\n  }\r\n\r\n  // system\r\n  var os = unknown;\r\n  var clientStrings = [\r\n    { s: 'Windows 10', r: /(Windows 10.0|Windows NT 10.0)/ },\r\n    { s: 'Windows 8.1', r: /(Windows 8.1|Windows NT 6.3)/ },\r\n    { s: 'Windows 8', r: /(Windows 8|Windows NT 6.2)/ },\r\n    { s: 'Windows 7', r: /(Windows 7|Windows NT 6.1)/ },\r\n    { s: 'Windows Vista', r: /Windows NT 6.0/ },\r\n    { s: 'Windows Server 2003', r: /Windows NT 5.2/ },\r\n    { s: 'Windows XP', r: /(Windows NT 5.1|Windows XP)/ },\r\n    { s: 'Windows 2000', r: /(Windows NT 5.0|Windows 2000)/ },\r\n    { s: 'Windows ME', r: /(Win 9x 4.90|Windows ME)/ },\r\n    { s: 'Windows 98', r: /(Windows 98|Win98)/ },\r\n    { s: 'Windows 95', r: /(Windows 95|Win95|Windows_95)/ },\r\n    { s: 'Windows NT 4.0', r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/ },\r\n    { s: 'Windows CE', r: /Windows CE/ },\r\n    { s: 'Windows 3.11', r: /Win16/ },\r\n    { s: 'Android', r: /Android/ },\r\n    { s: 'Open BSD', r: /OpenBSD/ },\r\n    { s: 'Sun OS', r: /SunOS/ },\r\n    { s: 'Chrome OS', r: /CrOS/ },\r\n    { s: 'Linux', r: /(Linux|X11(?!.*CrOS))/ },\r\n    { s: 'iOS', r: /(iPhone|iPad|iPod)/ },\r\n    { s: 'Mac OS X', r: /Mac OS X/ },\r\n    { s: 'Mac OS', r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/ },\r\n    { s: 'QNX', r: /QNX/ },\r\n    { s: 'UNIX', r: /UNIX/ },\r\n    { s: 'BeOS', r: /BeOS/ },\r\n    { s: 'OS/2', r: /OS\\/2/ },\r\n    {\r\n      s: 'Search Bot',\r\n      r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/,\r\n    },\r\n  ];\r\n  for (var id in clientStrings) {\r\n    var cs = clientStrings[id];\r\n    if (cs.r.test(nAgt)) {\r\n      os = cs.s;\r\n      break;\r\n    }\r\n  }\r\n\r\n  var osVersion = unknown;\r\n\r\n  if (/Windows/.test(os)) {\r\n    osVersion = /Windows (.*)/.exec(os)[1];\r\n    os = 'Windows';\r\n  }\r\n\r\n  switch (os) {\r\n    case 'Mac OS X':\r\n      osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(nAgt)[1];\r\n      break;\r\n\r\n    case 'Android':\r\n      osVersion = /Android ([\\.\\_\\d]+)/.exec(nAgt)[1];\r\n      break;\r\n\r\n    case 'iOS':\r\n      osVersion = /OS (\\d+)_(\\d+)_?(\\d+)?/.exec(nVer);\r\n      osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);\r\n      break;\r\n\r\n    default:\r\n      break;\r\n  }\r\n\r\n  // user agent string manipulation to obtain device model\r\n  var system = nAgt.substring(nAgt.indexOf('(') + 1, nAgt.indexOf(')'));\r\n  var device = system.substring(system.lastIndexOf(';') + 1);\r\n\r\n  // use JavaScript to detect GPU used from within your browser - by cvan\r\n  // https://gist.github.com/cvan/042b2448fcecefafbb6a91469484cdf8\r\n  var canvas = document.createElement('canvas');\r\n  var gl;\r\n  var debugInfo;\r\n  var gpuVendor;\r\n  var renderer;\r\n\r\n  try {\r\n    gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\r\n    // move block here if webgl not available\r\n    // if (gl) {\r\n    debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\r\n    gpuVendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);\r\n    renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\r\n    // }\r\n  } catch (e) {\r\n    //   do nothing\r\n  }\r\n  // ----------------------------------------------------------------\r\n\r\n  //   window.jscd = {\r\n  return {\r\n    browser: browser,\r\n    browserVersion: majorVersion,\r\n    browserRelease: version,\r\n    // vendor: navigator.vendor,\r\n    device: device,\r\n    os: os,\r\n    osVersion: osVersion,\r\n    mobile: mobile,\r\n    platform: navigator.platform,\r\n    screen: screenSize,\r\n    dpr: +window.devicePixelRatio.toFixed(3),\r\n    gpu: renderer,\r\n    gpuVendor: gpuVendor,\r\n    userAgent: navigator.userAgent,\r\n    // cookies: cookieEnabled,\r\n    // flashVersion: flashVersion\r\n  };\r\n}\r\n// (this)\r\n\r\n// alert(\r\n//     'OS: ' + jscd.os +' '+ jscd.osVersion + '\\n' +\r\n//     'Browser: ' + jscd.browser +' '+ jscd.browserMajorVersion +\r\n//       ' (' + jscd.browserVersion + ')\\n' +\r\n//     'Mobile: ' + jscd.mobile + '\\n' +\r\n//     'Flash: ' + jscd.flashVersion + '\\n' +\r\n//     'Cookies: ' + jscd.cookies + '\\n' +\r\n//     'Screen Size: ' + jscd.screen + '\\n\\n' +\r\n//     'Full User Agent: ' + navigator.userAgent\r\n// );\r\n","// TODO set max iterations as parameter\r\n\r\nconst newSmoothJuliaShader = ({\r\n  maxI = 300,\r\n  AA = 1,\r\n  B = 64,\r\n  // crosshair = {\r\n  //     stroke: 0,\r\n  //     radius: 0\r\n  // },\r\n}) => `\r\n\r\n#define AA ${AA}\r\n#define MAXI ${maxI}\r\n#define B ${B.toFixed(1)}\r\n\r\n// set high float precision (lower than this may break colours on mobile)\r\nprecision highp float;\r\n\r\n// need to know the resolution of the canvas\r\nuniform vec2 resolution;\r\n\r\n// properties should be passed as uniforms\r\nuniform int   u_maxI;\r\nuniform vec2  u_xy;\r\nuniform vec2  u_c;\r\nuniform float u_zoom;\r\nuniform float u_theta;\r\n\r\nfloat julia( vec2 z, vec2 c ) {\r\n\r\n  float l = 0.0;\r\n  for( int i=0; i<MAXI; i++ )\r\n  {\r\n      z = vec2( z.x*z.x - z.y*z.y, 2.0*z.x*z.y ) + c;\r\n      if( dot(z,z)>(B*B) ) break;\r\n      l += 1.0;\r\n  }\r\n\r\n  // maxed out iterations\r\n  if( l>float(MAXI)-1.0 ) return 0.0;\r\n\r\n  // equivalent optimized smooth interation count\r\n  l = l - log2(log2(dot(z,z))) + 4.0;\r\n\r\n  return l;\r\n}\r\n\r\nvoid main() {    \r\n  // set the initial colour to black\r\n  vec3 col = vec3(0.0);\r\n\r\n  // anti-aliasing\r\n  #if AA>1\r\n  for( int m=0; m<AA; m++ )\r\n  for( int n=0; n<AA; n++ )\r\n  {\r\n      vec2 p = (2.0*(gl_FragCoord.xy + vec2(float(m), float(n)) / float(AA) ) - resolution.xy)/resolution.y;\r\n      float w = float(AA*m+n);\r\n  #else    \r\n      // adjust pixels to range from [-1, 1]\r\n      vec2 p = (2.0*gl_FragCoord.xy - resolution.xy)/resolution.y;\r\n  #endif\r\n  \r\n  // constant \"c\" to add, based on mandelbrot position\r\n  vec2 c = u_c;\r\n\r\n  float sinT = sin(u_theta);\r\n  float cosT = cos(u_theta);\r\n\r\n  vec2 xy = vec2( p.x*cosT - p.y*sinT, p.x*sinT + p.y*cosT );\r\n  // c is based on offset and grid position, z_0 = 0\r\n  vec2 z = u_xy + xy/u_zoom;\r\n\r\n  float l = julia(z, c);\r\n  col += 0.5 + 0.5*cos( 3.0 + l*0.15 + vec3(0.0,0.6,1.0));\r\n\r\n  // antialiasing\r\n  #if AA>1\r\n  }\r\n  col /= float(AA*AA);\r\n  #endif\r\n\r\n  // Output to screen\r\n  gl_FragColor = vec4( col, 1.0 );\r\n}\r\n`;\r\n\r\nexport default newSmoothJuliaShader;\r\n","import { FormControlLabelProps } from '@material-ui/core';\nimport React from 'react';\n// https://stackoverflow.com/a/39281228/9184658\n\nexport type settingsDefinitionsType = {\n  showMinimap: boolean;\n  showCrosshair: boolean;\n  showCoordinates: boolean;\n  showFPS: boolean;\n  maxI: number;\n  useDPR: boolean;\n  useAA: boolean;\n};\n\nexport const defaultSettings = {\n  showMinimap: true,\n  showCrosshair: true,\n  showCoordinates: false,\n  maxI: 250,\n  showFPS: false,\n  useDPR: false,\n  useAA: false,\n};\n\nexport type settingsWidgetType = {\n  // - settings widgets key k must be in the set\n  // - its type must be of FormControlLabelProps (for displaying in the Material UI form)\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  [k in keyof settingsDefinitionsType]: FormControlLabelProps;\n  // using \"k\" results in an error since it is not used again\n};\n\nexport type settingsGroupType = {\n  name: string;\n  widgets: {\n    // widget groups may contain any of the keys in the settingsDefinitionsType\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    [k in keyof Partial<settingsDefinitionsType>]: FormControlLabelProps;\n    // using \"k\" results in an error since it is not used again\n  };\n};\n\nexport type SettingsContextType = {\n  settings: settingsDefinitionsType;\n  setSettings: React.Dispatch<React.SetStateAction<settingsDefinitionsType>>;\n  settingsWidgets: settingsWidgetType;\n};\n\nexport interface SettingsMenuProps {\n  reset: () => void;\n  toggleInfo: () => void;\n}\n","import { Slider, Switch } from '@material-ui/core';\nimport React from 'react';\nimport {\n  settingsDefinitionsType,\n  settingsGroupType,\n  settingsWidgetType,\n} from '../../common/settings';\n\nexport const settingsWidgets = (\n  settings: settingsDefinitionsType,\n): settingsWidgetType => ({\n  showMinimap: {\n    label: 'Minimap',\n    checked: settings.showMinimap,\n    control: <Switch />,\n  },\n  showCrosshair: {\n    label: 'Crosshair',\n    checked: settings.showCrosshair,\n    control: <Switch />,\n  },\n  showCoordinates: {\n    label: 'Show coordinates',\n    checked: settings.showCoordinates,\n    control: <Switch />,\n  },\n  maxI: {\n    label: 'Iterations',\n    value: settings.maxI,\n    labelPlacement: 'top',\n    style: {\n      marginLeft: 0,\n      marginRight: 0,\n    },\n    control: (\n      <Slider\n        min={10}\n        max={1000}\n        step={10}\n        valueLabelDisplay=\"auto\"\n        marks={[\n          { value: 10, label: 10 },\n          { value: 250, label: 250 },\n          { value: 500, label: 500 },\n          { value: 750, label: 750 },\n          { value: 1000, label: 1000 },\n        ]}\n      />\n    ),\n  },\n  useDPR: {\n    // https://stackoverflow.com/a/12830454/9184658\n    // // There is a downside that values like 1.5 will give \"1.50\" as the output. A fix suggested by @minitech:\n    // var numb = 1.5;\n    // numb = +numb.toFixed(2);\n    // // Note the plus sign that drops any \"extra\" zeroes at the end.\n    // // It changes the result (which is a string) into a number again (think \"0 + foo\"),\n    // // which means that it uses only as many digits as necessary.\n    label: `Use pixel ratio (${+window.devicePixelRatio.toFixed(3)})`,\n    checked: settings.useDPR,\n    control: <Switch />,\n  },\n  useAA: {\n    label: `Anti-aliasing (slow)`,\n    checked: settings.useAA,\n    control: <Switch />,\n  },\n  showFPS: {\n    label: `Show FPS`,\n    checked: settings.showFPS,\n    control: <Switch />,\n  },\n});\n\nexport const getSettingsWidgetsGrouping = (\n  settingsWidgets: settingsWidgetType,\n): Array<settingsGroupType> => [\n  {\n    name: 'Interface',\n    widgets: {\n      showMinimap: settingsWidgets.showMinimap,\n      showCrosshair: settingsWidgets.showCrosshair,\n      showCoordinates: settingsWidgets.showCoordinates,\n    },\n    // ],\n  },\n  {\n    name: 'Graphics',\n    widgets: {\n      maxI: settingsWidgets.maxI,\n      useDPR: settingsWidgets.useDPR,\n      useAA: settingsWidgets.useAA,\n      showFPS: settingsWidgets.showFPS,\n    },\n  },\n];\n","import React, { createContext, ReactNode, useState } from 'react';\nimport {\n  defaultSettings,\n  SettingsContextType,\n  settingsDefinitionsType,\n} from '../../common/settings';\nimport { settingsWidgets } from './SettingsDefinitions';\n\nexport const SettingsContext = createContext<SettingsContextType>({\n  // provide the context with the default values\n  settings: defaultSettings,\n  // can't set state until it's initialized\n  setSettings: () => {\n    return;\n  },\n  settingsWidgets: settingsWidgets(defaultSettings),\n});\n\n// export const useSettings = (): SettingsContextType => useContext(SettingsContext);\n\nexport const SettingsProvider = ({ children }: { children: ReactNode }): JSX.Element => {\n  // https://reactjs.org/docs/context.html#updating-context-from-a-nested-component\n  // no grouping: all settings are accessible\n  const [settings, setSettings] = useState<settingsDefinitionsType>(defaultSettings);\n\n  return (\n    <SettingsContext.Provider\n      value={{\n        settings,\n        setSettings,\n        settingsWidgets: settingsWidgets(settings),\n      }}\n    >\n      {children}\n    </SettingsContext.Provider>\n  );\n};\n\nexport default SettingsProvider;\n","import { colors, createMuiTheme } from '@material-ui/core';\r\n\r\nconst theme = createMuiTheme({\r\n  props: {\r\n    // Name of the component \r\n    MuiSwitch: {\r\n      // The default props to change\r\n      color: 'primary', // x, on the whole application !\r\n    },\r\n    MuiButton: {\r\n      variant: 'outlined',\r\n    },\r\n  },\r\n  palette: {\r\n    primary: {\r\n      main: colors.blue[700],\r\n    },\r\n    secondary: {\r\n      main: colors.red[700],\r\n    },\r\n    info: {\r\n      main: colors.blue[700],\r\n    },\r\n  },\r\n});\r\n\r\nexport const simpleBoxShadow = '0px 2px 10px 1px rgba(0, 0, 0, 0.4)';\r\n\r\nexport default theme;\r\n","export const fullVertexShader = `\r\nattribute vec4 position;\r\n\r\nvoid main() {\r\n  gl_Position = position;\r\n}\r\n`;\r\n\r\n// This \"position\" array specifies the vertex positions of the element\r\n// to be displayed by the vertex shader. It represents two triangles,\r\n// each filling half of the screen diagonally, and together filling the\r\n// full canvas space to allow the fragment shader to act on the full canvas.\r\nexport const fullscreenVertexArray = {\r\n  position: {\r\n    numComponents: 3,\r\n    data: [-1, -1, 0, 1, -1, 0, -1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, 0],\r\n  },\r\n};\r\n","import React, { useCallback, useEffect, useRef } from 'react';\r\nimport { animated } from 'react-spring';\r\nimport * as twgl from 'twgl.js';\r\nimport { WebGLCanvasProps } from '../../common/render';\r\nimport { fullscreenVertexArray, fullVertexShader } from '../../shaders/fullVertexShader';\r\n\r\n// https://mariusschulz.com/blog/typing-destructured-object-parameters-in-typescript\r\n// https://stackoverflow.com/a/50294843/9184658\r\nconst WebGLCanvas = React.forwardRef<\r\n  HTMLCanvasElement,\r\n  WebGLCanvasProps & { mini?: boolean }\r\n>((props, refAny) => {\r\n  // const { mini = false, ...rest } = props;\r\n  // props:\r\n  // id\r\n  // fragShader\r\n  // -- uniforms:\r\n  //    u_zoom\r\n  //    u_pos\r\n  //    u_maxI\r\n  // ref\r\n  // glRef\r\n\r\n  const canvasRef = refAny as React.MutableRefObject<HTMLCanvasElement>;\r\n\r\n  const gl = useRef<WebGLRenderingContext | null>();\r\n  const renderRequestRef = useRef<number>();\r\n  const bufferInfo = useRef<twgl.BufferInfo>();\r\n  const programInfo = useRef<twgl.ProgramInfo>();\r\n\r\n  const u = props.u;\r\n  const setFps = props.fps;\r\n\r\n  // have a zoom callback\r\n  // keeps minimaps at a fixed zoom level\r\n  const zoom = useCallback(() => (props.mini ? 1.0 : props.u.zoom.getValue()), [\r\n    props.mini,\r\n    props.u.zoom,\r\n  ]);\r\n\r\n  const dpr = props.useDPR ? window.devicePixelRatio : 1;\r\n\r\n  // canvas setup step - get webgl context\r\n  const setupCanvas = useCallback(() => {\r\n    gl.current = canvasRef.current.getContext('webgl');\r\n    console.debug(`WebGL canvas context created`);\r\n  }, [gl, canvasRef]);\r\n\r\n  useEffect(() => {\r\n    setupCanvas();\r\n\r\n    // https://www.khronos.org/webgl/wiki/HandlingContextLost\r\n    canvasRef.current.addEventListener(\r\n      'webglcontextlost',\r\n      (event) => {\r\n        console.error('WebGL context lost!');\r\n        event.preventDefault();\r\n        // trigger an error alert in future?\r\n      },\r\n      false,\r\n    );\r\n    canvasRef.current.addEventListener(\r\n      'webglcontextrestored',\r\n      (event) => {\r\n        console.error('WebGL context restored! Setting up...');\r\n        setupCanvas();\r\n      },\r\n      false,\r\n    );\r\n\r\n    // remove this context?\r\n    // return () => gl.current ??\r\n  }, [canvasRef, setupCanvas]);\r\n\r\n  const compileShader = useCallback(() => {\r\n    const ctx = gl.current as WebGLRenderingContext;\r\n    bufferInfo.current = twgl.createBufferInfoFromArrays(ctx, fullscreenVertexArray);\r\n    programInfo.current = twgl.createProgramInfo(ctx, [\r\n      fullVertexShader,\r\n      props.fragShader,\r\n    ]);\r\n    console.debug(`Fragment shader compiled`);\r\n  }, [gl, props.fragShader]);\r\n\r\n  // re-compile program if shader changes\r\n  useEffect(compileShader, [compileShader]);\r\n\r\n  const then = useRef(0);\r\n  const frames = useRef(0);\r\n  const elapsedTime = useRef(0);\r\n  // fps update interval\r\n  const interval = 1000;\r\n\r\n  // the main render function for WebGL\r\n  const render = useCallback(\r\n    (time) => {\r\n      const ctx = gl.current as WebGLRenderingContext;\r\n      const prog = programInfo.current as twgl.ProgramInfo;\r\n      const buff = bufferInfo.current as twgl.BufferInfo;\r\n\r\n      twgl.resizeCanvasToDisplaySize(canvasRef.current, dpr);\r\n      // scale the viewport to the canvas size\r\n      ctx.viewport(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n\r\n      const uniforms = {\r\n        resolution: [canvasRef.current.width, canvasRef.current.height],\r\n        u_zoom: zoom(),\r\n        u_c: u.c === undefined ? 0 : u.c.getValue(),\r\n        u_xy: u.xy.getValue(),\r\n        u_maxI: u.maxI,\r\n        u_theta: u.theta.getValue(),\r\n      };\r\n\r\n      ctx.useProgram(prog.program);\r\n      twgl.setBuffersAndAttributes(ctx, prog, buff);\r\n      twgl.setUniforms(prog, uniforms);\r\n      twgl.drawBufferInfo(ctx, buff);\r\n\r\n      // calculate fps\r\n      if (setFps !== undefined) {\r\n        frames.current++;\r\n        elapsedTime.current += time - then.current;\r\n        then.current = time;\r\n\r\n        // console.log(elapsedTime.current);\r\n        if (elapsedTime.current >= interval) {\r\n          //multiply with (1000 / elapsed) for accuracy\r\n          setFps((frames.current * (interval / elapsedTime.current)).toFixed(1));\r\n          frames.current = 0;\r\n          elapsedTime.current -= interval;\r\n\r\n          // document.getElementById('test').innerHTML = fps;\r\n        }\r\n        // time *= 0.001;                      // convert to seconds\r\n        // const deltaTime = time - then.current; // compute time since last frame\r\n        // then.current = time;                // remember time for next frame\r\n        // const fs = 1 / deltaTime;           // compute frames per second\r\n        // console.log(fs);\r\n        // (fs.toFixed(1));  // update fps display\r\n      }\r\n\r\n      // The 'state' will always be the initial value here\r\n      renderRequestRef.current = requestAnimationFrame(render);\r\n    },\r\n    [gl, u, zoom, dpr, setFps, interval, canvasRef],\r\n  );\r\n\r\n  useEffect(() => {\r\n    renderRequestRef.current = requestAnimationFrame(render);\r\n    return () => cancelAnimationFrame(renderRequestRef.current as number);\r\n  }, [render]);\r\n\r\n  return (\r\n    <animated.canvas\r\n      className=\"renderer\"\r\n      ref={refAny}\r\n      id={props.id}\r\n      style={{\r\n        // cursor should show whether the viewer is being grabbed\r\n        cursor: props.dragging ? 'grabbing' : 'grab',\r\n        // adding style allows direct style override\r\n        ...props.style,\r\n      }}\r\n    />\r\n  );\r\n});\r\n\r\nWebGLCanvas.displayName = 'WebGLCanvas';\r\n\r\nexport default WebGLCanvas;\r\n","import { ButtonBase, Grow } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { MinimapViewerProps } from '../../common/render';\r\nimport { simpleBoxShadow } from '../../theme/theme';\r\nimport WebGLCanvas from './WebGLCanvas';\r\n\r\nconst miniSize = 100;\r\n// TODO: make square with rounded corners?\r\nconst borderRadius = 8;\r\n\r\nconst MinimapViewer = (props: MinimapViewerProps): JSX.Element => {\r\n  const { canvasRef, onClick, show, ...rest } = props;\r\n  return (\r\n    <Grow in={show}>\r\n      <ButtonBase\r\n        style={{\r\n          position: 'absolute',\r\n          // make minimap stick out through backdrop\r\n          zIndex: 1300,\r\n          margin: '0.5rem',\r\n          left: 0,\r\n          bottom: 0,\r\n          // cursor: 'pointer',\r\n          height: miniSize,\r\n          width: miniSize,\r\n          borderRadius: borderRadius,\r\n          // border: \"1px solid #000\",\r\n          boxShadow: simpleBoxShadow,\r\n          overflow: 'hidden',\r\n          // opacity: zoom.interpolate((z) => _.clamp(z - 1, 0, 1)),\r\n          // display: zoom.interpolate((z) => (_.clamp(z - 1, 0, 1) === 0 ? 'none' : 'block')),\r\n        }}\r\n        onClick={onClick}\r\n      >\r\n        {/* <animated.div */}\r\n        {/* // \r\n      // > */}\r\n        <WebGLCanvas\r\n          id={props.id}\r\n          mini={true}\r\n          ref={canvasRef}\r\n          {...rest}\r\n          // setting border radius here stops the canvas clickable area from overflowing\r\n          // outside the div circle, which would make the clickable area a rectangle\r\n          style={{\r\n            borderRadius: borderRadius,\r\n            // cursor should be \"pointer\" (looks clickable) if this is a minimap,\r\n            cursor: 'pointer',\r\n          }}\r\n        />\r\n        {/* </animated.div> */}\r\n      </ButtonBase>\r\n    </Grow>\r\n  );\r\n};\r\nexport default MinimapViewer;\r\n","import React, { useRef, useState } from 'react';\r\nimport { useGesture } from 'react-use-gesture';\r\nimport { JuliaRendererProps } from '../../common/render';\r\nimport { MandelbrotMapsWebGLUniforms } from '../../common/types';\r\nimport { genericTouchBind } from '../../common/utils';\r\nimport newSmoothJuliaShader from '../../shaders/newSmoothJuliaShader';\r\nimport { SettingsContext } from '../settings/SettingsContext';\r\nimport MinimapViewer from './MinimapViewer';\r\nimport WebGLCanvas from './WebGLCanvas';\r\nexport default function JuliaRenderer(props: JuliaRendererProps): JSX.Element {\r\n  // variables to hold canvas and webgl information\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const miniCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n  const [{ xy }] = props.controls.xyCtrl;\r\n  const [{ z }, setControlZoom] = props.controls.zoomCtrl;\r\n  const [{ theta }] = props.controls.rotCtrl;\r\n  const maxI = props.maxI; // -> global\r\n  const AA = props.useAA ? 2 : 1;\r\n\r\n  const fragShader = newSmoothJuliaShader({\r\n    maxI: maxI,\r\n    AA: AA,\r\n  });\r\n\r\n  const miniFragShader = newSmoothJuliaShader({\r\n    maxI: maxI,\r\n    AA: 2,\r\n  });\r\n\r\n  const u: MandelbrotMapsWebGLUniforms = {\r\n    zoom: z,\r\n    xy: xy,\r\n    c: props.c,\r\n    theta: theta,\r\n    maxI: maxI,\r\n  };\r\n\r\n  const [dragging, setDragging] = useState(false);\r\n\r\n  const gtb = genericTouchBind({\r\n    domTarget: canvasRef,\r\n    controls: props.controls,\r\n    setDragging: setDragging,\r\n  });\r\n\r\n  useGesture(gtb.handlers, gtb.config);\r\n\r\n  return (\r\n    <SettingsContext.Consumer>\r\n      {({ settings }) => (\r\n        <div\r\n          className=\"renderer\"\r\n          style={{\r\n            position: 'relative',\r\n          }}\r\n        >\r\n          <WebGLCanvas\r\n            id=\"julia-canvas\"\r\n            fragShader={fragShader}\r\n            useDPR={props.useDPR}\r\n            u={u}\r\n            ref={canvasRef}\r\n            dragging={dragging}\r\n          />\r\n          <MinimapViewer\r\n            id=\"julia-minimap-canvas\"\r\n            fragShader={miniFragShader}\r\n            useDPR={settings.useDPR}\r\n            u={u}\r\n            canvasRef={miniCanvasRef}\r\n            onClick={() => setControlZoom({ z: 1 })}\r\n            show={settings.showMinimap}\r\n          />\r\n        </div>\r\n      )}\r\n    </SettingsContext.Consumer>\r\n  );\r\n}\r\n","// TODO set max iterations as parameter, crosshair as parameter\r\n\r\nconst makeCrosshair = (stroke: number, radius: number) => ({\r\n  stroke,\r\n  radius,\r\n});\r\n\r\nexport const standardCrosshair = makeCrosshair(2, 100);\r\nexport const miniCrosshair = makeCrosshair(1, 30);\r\n\r\nexport interface MandelbrotShaderParams {\r\n  maxI: number;\r\n  /** Radial boundary */\r\n  B: number;\r\n  /** Anti-aliasing samples */\r\n  AA: number;\r\n}\r\n\r\nconst newSmoothMandelbrotShader = (\r\n  { maxI = 300, AA = 1, B = 64 },\r\n  showCrosshair = true,\r\n  crosshairShape = {\r\n    stroke: 2,\r\n    radius: 100,\r\n  },\r\n): string => {\r\n  return `\r\n// Adapted by Joao Maio/2019, based on work by inigo quilez - iq/2013\r\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\r\n\r\n// See here for more information on smooth iteration count:\r\n// http://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n\r\n#define false 0\r\n#define true 1\r\n\r\n// render parameters\r\n#define AA ${AA}\r\n#define MAXI ${maxI}\r\n#define B ${B.toFixed(1)}\r\n\r\n// crosshair parameters\r\n#define show_crosshair ${showCrosshair}\r\n#define cross_stroke ${crosshairShape.stroke.toFixed(1)}\r\n#define cross_radius ${crosshairShape.radius.toFixed(1)}\r\n\r\n// set high float precision (lower than this may break colours on mobile)\r\nprecision highp float;\r\n\r\n// need to know the resolution of the canvas\r\nuniform vec2 resolution;\r\n\r\n// properties should be passed as uniforms\r\nuniform int   u_maxI;  \r\nuniform vec2  u_xy;\r\nuniform float u_zoom;\r\nuniform float u_theta;\r\n\r\nbool crosshair( float x, float y ) {\r\n  float abs_x = abs(2.0*x - resolution.x);\r\n  float abs_y = abs(2.0*y - resolution.y);\r\n\r\n  return \r\n  // crosshair in centre of screen\r\n  (abs_x <= cross_stroke || abs_y <= cross_stroke) &&\r\n  // crosshair size / \"radius\"\r\n  (abs_x <= cross_radius && abs_y <= cross_radius);\r\n}\r\n\r\nfloat mandelbrot( in vec2 c ) {\r\n    {\r\n        float c2 = dot(c, c);\r\n        // skip computation inside M1 - http://iquilezles.org/www/articles/mset_1bulb/mset1bulb.htm\r\n        if( 256.0*c2*c2 - 96.0*c2 + 32.0*c.x - 3.0 < 0.0 ) return 0.0;\r\n        // skip computation inside M2 - http://iquilezles.org/www/articles/mset_2bulb/mset2bulb.htm\r\n        if( 16.0*(c2+2.0*c.x+1.0) - 1.0 < 0.0 ) return 0.0;\r\n    }\r\n\r\n    float l = 0.0;\r\n    vec2 z  = vec2(0.0);\r\n    for( int i=0; i<MAXI; i++ )\r\n    {\r\n        z = vec2( z.x*z.x - z.y*z.y, 2.0*z.x*z.y ) + c;\r\n        if( dot(z,z)>(B*B) ) break;\r\n        l += 1.0;\r\n    }\r\n\r\n    // maxed out iterations\r\n    if( l>float(MAXI)-1.0 ) return 0.0;\r\n    \r\n    // optimized smooth interation count\r\n    l = l - log2(log2(dot(z,z))) + 4.0;\r\n\r\n    return l;\r\n}\r\n\r\nvoid main() {    \r\n    // set the initial colour to black\r\n    vec3 col = vec3(0.0);\r\n\r\n    // anti-aliasing\r\n    #if AA>1\r\n    for( int m=0; m<AA; m++ )\r\n    for( int n=0; n<AA; n++ )\r\n    {\r\n        // vec2 p = (-iResolution.xy + 2.0*(fragCoord.xy+vec2(float(m),float(n))/float(AA)))/iResolution.y;\r\n        vec2 p = (2.0*(gl_FragCoord.xy + vec2(float(m), float(n)) / float(AA) ) - resolution.xy)/resolution.y;\r\n        float w = float(AA*m+n);\r\n    #else    \r\n        // adjust pixels to range from [-1, 1]\r\n        vec2 p = (2.0*gl_FragCoord.xy - resolution.xy)/resolution.y;\r\n    #endif\r\n\r\n    float sinT = sin(u_theta);\r\n    float cosT = cos(u_theta);\r\n\r\n    vec2 xy = vec2( p.x*cosT - p.y*sinT, p.x*sinT + p.y*cosT );\r\n    // c is based on offset and grid position, z_0 = 0\r\n    vec2 c = u_xy + xy/u_zoom;\r\n    \r\n    float l = mandelbrot(c);\r\n    col += 0.5 + 0.5*cos( 3.0 + l*0.15 + vec3(0.0,0.6,1.0));\r\n\r\n    // antialiasing\r\n    #if AA>1\r\n    }\r\n    col /= float(AA*AA);\r\n    #endif\r\n\r\n    #if show_crosshair\r\n    if (crosshair(gl_FragCoord.x, gl_FragCoord.y)) {\r\n        col = 1. - col;\r\n    }\r\n    #endif\r\n\r\n    // Output to screen\r\n    gl_FragColor = vec4( col, 1.0 );\r\n}\r\n    `;\r\n};\r\n\r\nexport default newSmoothMandelbrotShader;\r\n","import { Card, Grow } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { animated } from 'react-spring';\r\nimport { FPSCardProps } from '../../common/info';\r\n\r\nconst FPSCard = (props: FPSCardProps): JSX.Element => (\r\n  <Grow in={props.show}>\r\n    <Card\r\n      style={{\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        padding: '4px 12px',\r\n        margin: 6,\r\n        fontFamily: 'monospace',\r\n        borderRadius: 100,\r\n        fontSize: '1.8rem',\r\n        zIndex: 1300,\r\n        userSelect: 'none',\r\n      }}\r\n    >\r\n      <animated.div>{props.fps}</animated.div>\r\n    </Card>\r\n  </Grow>\r\n);\r\n\r\nexport default FPSCard;\r\n","import React, { useRef, useState } from 'react';\r\nimport { useGesture } from 'react-use-gesture';\r\nimport { MandelbrotRendererProps } from '../../common/render';\r\nimport { genericTouchBind } from '../../common/utils';\r\nimport newSmoothMandelbrotShader, {\r\n  miniCrosshair,\r\n  standardCrosshair,\r\n} from '../../shaders/newSmoothMandelbrotShader';\r\nimport FPSCard from '../info/FPSCard';\r\nimport { SettingsContext } from '../settings/SettingsContext';\r\nimport MinimapViewer from './MinimapViewer';\r\nimport WebGLCanvas from './WebGLCanvas';\r\n\r\nexport default function MandelbrotRenderer(props: MandelbrotRendererProps): JSX.Element {\r\n  // variables to hold canvas and webgl information\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const miniCanvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n  // const gl = useRef<WebGLRenderingContext>(null);\r\n  // const miniGl = useRef<WebGLRenderingContext>(null);\r\n\r\n  // this multiplier subdivides the screen space into smaller increments\r\n  // to allow for velocity calculations to not immediately decay, due to the\r\n  // otherwise small scale that is being mapped to the screen.\r\n  // const screenScaleMultiplier = props.screenScaleMultiplier; // -> global\r\n\r\n  // temporary bounds to prevent excessive panning\r\n  // eslint-disable-next-line\r\n  const radialBound = 1;\r\n  // const relativeRadialBound = radialBound;// / -screenScaleMultiplier;\r\n\r\n  // read incoming props\r\n  const [{ xy }] = props.controls.xyCtrl;\r\n  // const [{ theta, last_pointer_angle }, setControlRot] = props.controls.rot;\r\n  const [{ z }, setControlZoom] = props.controls.zoomCtrl;\r\n  const [{ theta }] = props.controls.rotCtrl;\r\n  const maxI = props.maxI; // -> global\r\n  const AA = props.useAA ? 2 : 1; // -> global\r\n\r\n  const fragShader = newSmoothMandelbrotShader(\r\n    {\r\n      maxI: maxI,\r\n      AA: AA,\r\n    },\r\n    props.showCrosshair,\r\n    standardCrosshair,\r\n  );\r\n  const miniFragShader = newSmoothMandelbrotShader(\r\n    {\r\n      maxI: maxI,\r\n      AA: 2,\r\n    },\r\n    props.showCrosshair,\r\n    miniCrosshair,\r\n  );\r\n\r\n  const [dragging, setDragging] = useState(false);\r\n\r\n  const gtb = genericTouchBind({\r\n    domTarget: canvasRef,\r\n    controls: props.controls,\r\n    // gl: gl,\r\n    setDragging: setDragging,\r\n  });\r\n\r\n  // https://use-gesture.netlify.app/docs/changelog/#breaking\r\n  // When adding events directly to the dom element using `domTarget`\r\n  // you no longer need to clean the effect yourself.\r\n  // const touchBind =\r\n  useGesture(gtb.handlers, gtb.config);\r\n\r\n  // useEffect(() => {\r\n  //   touchBind();\r\n  // }, [touchBind]);\r\n\r\n  const [fps, setFps] = useState('');\r\n\r\n  return (\r\n    <SettingsContext.Consumer>\r\n      {({ settings }) => (\r\n        <div\r\n          className=\"renderer\"\r\n          style={{\r\n            position: 'relative',\r\n          }}\r\n        >\r\n          <FPSCard fps={fps} show={settings.showFPS} />\r\n\r\n          <WebGLCanvas\r\n            id=\"mandelbrot-canvas\"\r\n            fragShader={fragShader}\r\n            useDPR={settings.useDPR}\r\n            // touchBind={touchBind}\r\n            u={{\r\n              zoom: z,\r\n              xy: xy,\r\n              theta: theta,\r\n              maxI: maxI,\r\n              // screenScaleMultiplier: screenScaleMultiplier,\r\n            }}\r\n            ref={canvasRef}\r\n            // glRef={gl}\r\n            fps={setFps}\r\n            dragging={dragging}\r\n          />\r\n\r\n          <MinimapViewer\r\n            id=\"mandelbrot-minimap-canvas\"\r\n            fragShader={miniFragShader}\r\n            useDPR={settings.useDPR}\r\n            u={{\r\n              zoom: z,\r\n              xy: xy,\r\n              theta: theta,\r\n              maxI: maxI,\r\n              // screenScaleMultiplier: screenScaleMultiplier,\r\n            }}\r\n            canvasRef={miniCanvasRef}\r\n            // glRef={miniGl}\r\n            show={settings.showMinimap}\r\n            onClick={() => setControlZoom({ z: 1 })}\r\n          />\r\n        </div>\r\n      )}\r\n    </SettingsContext.Consumer>\r\n  );\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","// https://felixgerschau.com/create-a-pwa-update-notification-with-create-react-app/\r\n\r\nimport { Button, Snackbar } from '@material-ui/core';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport React, { FC, useEffect } from 'react';\r\nimport * as serviceWorker from '../serviceWorker';\r\n\r\nconst ServiceWorkerWrapper: FC = () => {\r\n  const [showReload, setShowReload] = React.useState(false);\r\n  const [waitingWorker, setWaitingWorker] = React.useState<ServiceWorker | null>(null);\r\n\r\n  const onSWUpdate = (registration: ServiceWorkerRegistration) => {\r\n    console.log('Out of date version detected! Triggering snackbar.');\r\n    setShowReload(true);\r\n    setWaitingWorker(registration.waiting);\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log('Registering Service Worker for update detection...');\r\n    serviceWorker.register({ onUpdate: onSWUpdate });\r\n  }, []);\r\n\r\n  const reloadPage = () => {\r\n    // optional chaining was not working here...\r\n    // https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html\r\n    waitingWorker && waitingWorker.postMessage({ type: 'SKIP_WAITING' });\r\n    setShowReload(false);\r\n    // reload(b: Boolean) is deprecated\r\n    window.location.reload();\r\n  };\r\n\r\n  return (\r\n    <Snackbar open={showReload} anchorOrigin={{ vertical: 'top', horizontal: 'center' }}>\r\n      <Alert\r\n        severity=\"info\"\r\n        action={\r\n          <Button color=\"inherit\" variant=\"outlined\" size=\"small\" onClick={reloadPage}>\r\n            Update\r\n          </Button>\r\n        }\r\n      >\r\n        A new version is available!\r\n      </Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default ServiceWorkerWrapper;\r\n","import {\n  Backdrop,\n  Divider,\n  Fab,\n  FormControlLabel,\n  FormControlLabelProps,\n  FormGroup,\n  Grid,\n  makeStyles,\n  Popover,\n  Typography,\n} from '@material-ui/core';\nimport Button from '@material-ui/core/Button';\nimport InfoIcon from '@material-ui/icons/Info';\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport React, { useState } from 'react';\nimport { SettingsMenuProps } from '../../common/settings';\nimport { SettingsContext } from './SettingsContext';\nimport { getSettingsWidgetsGrouping } from './SettingsDefinitions';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    display: 'flex',\n    flexDirection: 'column',\n    zIndex: 2,\n  },\n  button: {\n    padding: '6px 12px',\n    marginTop: 10,\n  },\n  sliderControl: {\n    width: 30,\n  },\n}));\n\nconst GroupDivider = () => <Divider style={{ marginTop: 10, marginBottom: 4 }} />;\nconst GroupTitle = (props: { title: string }) => (\n  <Typography variant=\"overline\" style={{ fontSize: 14, marginBottom: 4 }}>\n    {props.title}\n  </Typography>\n);\n\nexport default function SettingsMenu(props: SettingsMenuProps): JSX.Element {\n  const classes = useStyles();\n\n  const [anchorEl, setAnchorEl] = useState<EventTarget & HTMLButtonElement>();\n\n  // interface BottomButtonProps extends {\n  //   icon: JSX.Element;\n  //   text: string;\n  //   color: 'inherit' | 'default' | 'primary' | 'secondary' | undefined;\n  //   onClick: () => void;\n  // }\n  // const BottomButton = (props: BottomButtonProps) => (\n  //   <Button\n  //     variant=\"outlined\"\n  //     color={props.color}\n  //     aria-controls={props.text.toLowerCase()}\n  //     onClick={() => props.onClick()}\n  //     className={classes.button}\n  //     startIcon={<MyLocationIcon />}\n  //   >\n  //     Reset\n  //   </Button>\n  // );\n\n  const ResetButton = () => (\n    <Button\n      startIcon={<MyLocationIcon />}\n      color=\"secondary\"\n      aria-controls=\"reset\"\n      onClick={() => {\n        props.reset();\n      }}\n      className={classes.button}\n    >\n      Reset\n    </Button>\n  );\n  const AboutButton = () => (\n    <Button\n      startIcon={<InfoIcon />}\n      color=\"primary\"\n      aria-controls=\"about\"\n      onClick={() => {\n        props.toggleInfo();\n        setAnchorEl(undefined);\n      }}\n      className={classes.button}\n    >\n      About\n    </Button>\n  );\n\n  return (\n    <div className={classes.root}>\n      <Fab\n        aria-controls=\"menu\"\n        aria-haspopup=\"true\"\n        aria-label=\"settings\"\n        size=\"small\"\n        onClick={(e) => setAnchorEl(e.currentTarget)}\n        // className={classes.button}\n      >\n        <SettingsIcon />\n      </Fab>\n      <Backdrop open={Boolean(anchorEl)}>\n        <Popover\n          id=\"menu\"\n          anchorEl={anchorEl}\n          keepMounted\n          open={Boolean(anchorEl)}\n          onClose={() => setAnchorEl(undefined)}\n          anchorOrigin={{\n            horizontal: 'right',\n            vertical: 'bottom',\n          }}\n          transformOrigin={{\n            vertical: 'bottom',\n            horizontal: 'right',\n          }}\n        >\n          <Grid\n            container\n            direction=\"column\"\n            style={{\n              paddingLeft: '1.5em',\n              paddingRight: '1.5em',\n              paddingTop: '1em',\n              paddingBottom: '1em',\n            }}\n          >\n            <Grid item container alignItems=\"center\" justify=\"space-around\">\n              <Grid item>\n                <Typography variant=\"h1\" style={{ fontSize: 20, padding: 10 }}>\n                  Configuration\n                </Typography>\n              </Grid>\n              {/* <Divider orientation=\"vertical\" flexItem /> */}\n              {/* <Grid item>\n                <IconButton\n                  aria-label=\"info\"\n                  size=\"medium\"\n                  onClick={() => {\n                    // open info panel\n                    props.toggleInfo();\n                    // close popover\n                    setAnchorEl(undefined);\n                  }}\n                >\n                  <InfoIcon fontSize=\"inherit\" />\n                </IconButton>\n              </Grid> */}\n            </Grid>\n            <SettingsContext.Consumer>\n              {({ setSettings, settingsWidgets }) =>\n                getSettingsWidgetsGrouping(settingsWidgets).map((g) => (\n                  <Grid item key={g.name}>\n                    <GroupDivider />\n                    <GroupTitle title={g.name} />\n                    <FormGroup>\n                      {Object.entries(g.widgets).map(([k, widget]) => (\n                        <FormControlLabel\n                          key={`${k}-control`}\n                          style={{ userSelect: 'none' }}\n                          {...(widget as FormControlLabelProps)}\n                          onChange={(e, val) => {\n                            console.log(`${k} -> ${val}`);\n                            setSettings((prevState) => ({\n                              ...prevState,\n                              [k]: val,\n                            }));\n                          }}\n                        />\n                      ))}\n                    </FormGroup>\n                  </Grid>\n                ))\n              }\n            </SettingsContext.Consumer>\n\n            <GroupDivider />\n\n            <Grid container direction=\"row\" justify=\"space-between\" alignItems=\"stretch\">\n              <Grid item>\n                <ResetButton />\n              </Grid>\n              <Grid item style={{ width: '0.5rem' }} />\n              <Grid item>\n                <AboutButton />\n              </Grid>\n            </Grid>\n\n            {/* <Button\n              aria-controls=\"reset\"\n              onClick={() => props.reset()}\n              className={classes.button}\n              startIcon={<MyLocationIcon />}\n            >\n              Reset\n            </Button> */}\n            {/* <Grid item xs>\n                <Button\n                  aria-controls=\"reset\"\n                  onClick={() => props.reset()}\n                  className={classes.button}\n                  startIcon={<MyLocationIcon />}\n                >\n                  Reset\n                </Button>\n              </Grid>\n              <Grid item xs>\n                <Button\n                  aria-label=\"info\"\n                  size=\"medium\"\n                  onClick={() => {\n                    // open info panel\n                    props.toggleInfo();\n                    // close popover\n                    setAnchorEl(undefined);\n                  }}\n                  className={classes.button}\n                  startIcon={<InfoIcon />}\n                >\n                  About\n                </Button>\n              </Grid> */}\n          </Grid>\n        </Popover>\n      </Backdrop>\n    </div>\n  );\n}\n","import { Grid, ThemeProvider } from '@material-ui/core';\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { useSpring } from 'react-spring';\r\nimport './App.css';\r\nimport {\r\n  currentLocation,\r\n  useHashLocation,\r\n  useHashNavigator,\r\n  ViewerURLManager,\r\n} from './common/routing';\r\nimport {\r\n  ViewerControlSprings,\r\n  ViewerLocation,\r\n  ViewerRotationControl,\r\n  ViewerXYControl,\r\n  ViewerZoomControl,\r\n} from './common/types';\r\nimport { useWindowSize, warpToPoint } from './common/utils';\r\nimport { springsConfigs, viewerOrigin } from './common/values';\r\nimport CoordinateInterface from './components/info/CoordinateInterface';\r\nimport InfoDialog from './components/info/InfoDialog';\r\nimport JuliaRenderer from './components/render/JuliaRenderer';\r\n// import 'typeface-roboto';\r\nimport MandelbrotRenderer from './components/render/MandelbrotRenderer';\r\nimport ServiceWorkerWrapper from './components/ServiceWorkerWrapper';\r\nimport SettingsProvider, { SettingsContext } from './components/settings/SettingsContext';\r\nimport SettingsMenu from './components/settings/SettingsMenu';\r\nimport theme from './theme/theme';\r\n\r\nfunction App(): JSX.Element {\r\n  const size = useWindowSize();\r\n\r\n  // if app is started with a hash location, assume\r\n  // it should be the starting position\r\n  // detects hash updates\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const [loc, navigate] = useHashLocation();\r\n\r\n  // non-reloading hash update\r\n  const updateBrowserHash = useHashNavigator();\r\n\r\n  const urlManager = useMemo(() => new ViewerURLManager(), []);\r\n\r\n  // generic callback\r\n  const updateHash = useCallback(\r\n    (name: string, v: Partial<ViewerLocation>) => {\r\n      urlManager.updateViewer(name, v);\r\n      const u = urlManager.asFullHashURL();\r\n      // console.debug(`Updated # for ${name} => ${u}`);\r\n      updateBrowserHash(u);\r\n    },\r\n    [updateBrowserHash, urlManager],\r\n  );\r\n\r\n  // callbacks for springs to update url when animation stops\r\n  const updateM = (v: Partial<ViewerLocation>) => updateHash('m', v);\r\n  const updateJ = (v: Partial<ViewerLocation>) => updateHash('j', v);\r\n\r\n  const mandelbrotControls: ViewerControlSprings = {\r\n    xyCtrl: useSpring<ViewerXYControl>(() => ({\r\n      xy: viewerOrigin.xy,\r\n      config: springsConfigs.default.xy,\r\n      onRest: updateM,\r\n    })),\r\n\r\n    zoomCtrl: useSpring<ViewerZoomControl>(() => ({\r\n      z: viewerOrigin.z,\r\n      minZoom: 0.5,\r\n      maxZoom: 100000,\r\n      config: springsConfigs.default.zoom,\r\n      onRest: updateM,\r\n    })),\r\n\r\n    rotCtrl: useSpring<ViewerRotationControl>(() => ({\r\n      theta: viewerOrigin.theta, // all angles in rad\r\n      config: springsConfigs.default.rot,\r\n      onRest: updateM,\r\n    })),\r\n  };\r\n\r\n  const juliaControls: ViewerControlSprings = {\r\n    xyCtrl: useSpring<ViewerXYControl>(() => ({\r\n      xy: viewerOrigin.xy,\r\n      config: springsConfigs.default.xy,\r\n      onRest: updateJ,\r\n    })),\r\n\r\n    zoomCtrl: useSpring<ViewerZoomControl>(() => ({\r\n      z: viewerOrigin.z,\r\n      minZoom: 0.5,\r\n      maxZoom: 2000,\r\n      config: springsConfigs.default.zoom,\r\n      onRest: updateJ,\r\n    })),\r\n\r\n    rotCtrl: useSpring<ViewerRotationControl>(() => ({\r\n      theta: viewerOrigin.theta, // all angles in rad\r\n      config: springsConfigs.default.rot,\r\n      onRest: updateJ,\r\n    })),\r\n  };\r\n\r\n  useEffect(() => {\r\n    // viewer should update if user goes back / forward on the page\r\n    // parse current location after user change\r\n    urlManager.updateFromURL();\r\n    console.log(`Warping to requested url => ${currentLocation()}`);\r\n\r\n    // warp to the newly parsed locations\r\n    warpToPoint(mandelbrotControls, urlManager.vs['m'].v);\r\n    warpToPoint(juliaControls, urlManager.vs['j'].v);\r\n    // this update process should only trigger when the hash location changes\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [loc]);\r\n\r\n  const reset = () => {\r\n    warpToPoint(mandelbrotControls, viewerOrigin);\r\n    warpToPoint(juliaControls, viewerOrigin);\r\n  };\r\n\r\n  const [showInfo, setShowInfo] = useState(false);\r\n\r\n  const toggleInfo = () => setShowInfo(!showInfo);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <ServiceWorkerWrapper />\r\n      <SettingsProvider>\r\n        <Grid container>\r\n          <SettingsContext.Consumer>\r\n            {({ settings }) => (\r\n              <Grid\r\n                item\r\n                container\r\n                direction={\r\n                  (size.width || 1) < (size.height || 0) ? 'column-reverse' : 'row'\r\n                }\r\n                justify=\"center\"\r\n                className=\"fullSize\"\r\n                style={{\r\n                  position: 'absolute',\r\n                }}\r\n              >\r\n                <CoordinateInterface\r\n                  show={settings.showCoordinates}\r\n                  mandelbrot={mandelbrotControls}\r\n                />\r\n                <Grid item xs className=\"renderer\">\r\n                  <MandelbrotRenderer controls={mandelbrotControls} {...settings} />\r\n                </Grid>\r\n                <Grid item xs className=\"renderer\">\r\n                  <JuliaRenderer\r\n                    c={mandelbrotControls.xyCtrl[0].xy}\r\n                    controls={juliaControls}\r\n                    {...settings}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n            )}\r\n          </SettingsContext.Consumer>\r\n\r\n          <SettingsMenu reset={() => reset()} toggleInfo={() => toggleInfo()} />\r\n\r\n          <InfoDialog ctrl={[showInfo, setShowInfo]} />\r\n        </Grid>\r\n      </SettingsProvider>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n// import * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// The default service worker is not used: it's overridden instead\r\n// by the ServiceWorkerWrapper (ServiceWorkerWrapper.tsx)\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\n// serviceWorker.register();\r\n"],"sourceRoot":""}