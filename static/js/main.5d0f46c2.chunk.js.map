{"version":3,"sources":["components/info/CoordinatesCard.tsx","components/info/ChangeCoordinatesCard.tsx","components/info/InfoDialog.jsx","shaders/newSmoothJuliaShader.js","theme/theme.tsx","shaders/fullVertexShader.js","components/render/WebGLCanvas.tsx","components/render/MinimapViewer.tsx","components/utils.js","components/settings/SettingsDefinitions.tsx","components/settings/SettingsContext.tsx","components/render/JuliaRenderer.jsx","shaders/newSmoothMandelbrotShader.js","components/info/FPSCard.tsx","components/render/MandelbrotRenderer.jsx","serviceWorker.js","components/ServiceWorkerWrapper.tsx","components/settings/SettingsMenu.tsx","App.tsx","index.tsx"],"names":["CoordinatesCard","props","Grow","in","show","Card","style","width","zIndex","position","padding","marginBottom","Typography","align","fontFamily","fontSize","span","mandelbrot","interpolate","x","y","screenScaleMultiplier","toFixed","ChangeCoordinatesCard","useState","startPos","setX","setY","startZoom","zoom","setZoom","display","flexDirection","flexShrink","Box","TextField","size","onChange","e","Number","target","value","label","Button","marginTop","onClick","xyCtrl","xy","vScale","config","resetPosSpringConfig","zoomCtrl","resetZoomSpringConfig","DialogTitle","withStyles","theme","root","margin","spacing","image","marginRight","height","closeButton","marginLeft","color","palette","grey","children","classes","onClose","other","disableTypography","className","src","alt","variant","IconButton","aria-label","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Alert","elevation","InfoDialog","ctrl","open","setOpen","snackBarOpen","setSnackBarOpen","handleClose","clientData","window","jscd","Dialog","aria-labelledby","maxWidth","id","dividers","gutterBottom","Link","href","Divider","TableContainer","component","Paper","Table","TableHead","TableRow","TableCell","colSpan","TableBody","Object","entries","map","k","v","key","String","data","navigator","clipboard","writeText","prompt","writeToClipboard","JSON","stringify","startIcon","Snackbar","autoHideDuration","severity","autoFocus","surveyLink","newSmoothJuliaShader","maxI","AA","B","createMuiTheme","MuiSwitch","MuiButton","primary","main","colors","blue","secondary","red","info","fullscreenVertexArray","numComponents","WebGLCanvas","React","forwardRef","refAny","ref","gl","glRef","renderRequestRef","useRef","bufferInfo","programInfo","u","setFps","fps","mini","getValue","currZoom","dpr","useDPR","devicePixelRatio","useEffect","current","getContext","twgl","fragShader","then","frames","elapsedTime","render","useCallback","time","viewport","canvas","uniforms","resolution","u_zoom","u_c","undefined","c","u_xy","u_maxI","useProgram","program","requestAnimationFrame","cancelAnimationFrame","cursor","dragging","displayName","MinimapViewer","canvasRef","rest","ButtonBase","left","bottom","borderRadius","boxShadow","overflow","genericTouchBind","domTarget","posControl","zoomControl","setDragging","setControlXY","minZoom","maxZoom","setControlZoom","binds","onDragStart","event","preventDefault","onPinchStart","onPinch","vd","vdva","down","dx","delta","origin","first","memo","z","newZ","newZclamp","_","clamp","immediate","velocity","onWheel","my","movement","active","onDrag","direction","pinching","realZoom","plotMovement","relMove","relDir","addV","decay","eventOptions","passive","capture","settingsWidgets","settings","showMinimap","checked","control","Switch","showCrosshair","showCoordinates","labelPlacement","Slider","min","max","step","valueLabelDisplay","marks","useAA","showFPS","defaultSettings","SettingsContext","createContext","setSettings","SettingsProvider","Provider","JuliaRenderer","miniCanvasRef","miniGl","screenmult","controls","miniFragShader","gtb","touchBind","useGesture","Consumer","makeCrosshair","stroke","radius","standardCrosshair","miniCrosshair","newSmoothMandelbrotShader","crosshairShape","FPSCard","top","userSelect","div","MandelbrotRenderer","isLocalhost","Boolean","location","hostname","match","register","URL","process","addEventListener","swUrl","fetch","response","contentType","headers","get","status","indexOf","serviceWorker","ready","registration","unregister","reload","registerValidSW","catch","console","log","checkValidServiceWorker","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","error","ServiceWorkerWrapper","showReload","setShowReload","waitingWorker","setWaitingWorker","onSWUpdate","waiting","anchorOrigin","vertical","horizontal","action","postMessage","type","useStyles","makeStyles","right","button","sliderControl","GroupDivider","GroupTitle","title","SettingsMenu","anchorEl","setAnchorEl","ResetButton","aria-controls","reset","AboutButton","toggleInfo","Fab","aria-haspopup","currentTarget","Backdrop","Popover","keepMounted","transformOrigin","Grid","container","paddingLeft","paddingRight","paddingTop","paddingBottom","item","alignItems","justify","name","widgets","getSettingsWidgetsGrouping","g","FormGroup","widget","FormControlLabel","val","prevState","defaultSpringConfig","mass","tension","friction","App","isClient","getSize","innerWidth","innerHeight","windowSize","setWindowSize","handleResize","removeEventListener","useWindowSize","mandelbrotControls","useSpring","rotCtrl","theta","juliaControls","showInfo","setShowInfo","ThemeProvider","xs","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.5d0f46c2.chunk.js","sourcesContent":["import { Card, Grow, Typography } from '@material-ui/core';\nimport React from 'react';\nimport { animated } from 'react-spring';\nimport { CoordinatesCardProps } from '../../common/info';\n\nconst CoordinatesCard = (props: CoordinatesCardProps): JSX.Element => {\n  return (\n    <Grow in={props.show}>\n      <Card\n        style={{\n          width: 'auto',\n          zIndex: 1300,\n          position: 'relative',\n          padding: '6px 12px',\n          marginBottom: 8,\n          // display: props.show ? 'block' : 'none',\n          // borderRadius: 100,\n        }}\n      >\n        <Typography align=\"right\" style={{ fontFamily: 'monospace', fontSize: '1.2rem' }}>\n          {/* https://www.typescriptlang.org/docs/handbook/basic-types.html#tuple */}\n          {/* https://www.typescriptlang.org/docs/handbook/2/objects.html#tuple-types */}\n          <animated.span>\n            {props.mandelbrot.interpolate(\n              // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n              (x, y) => `${(x * props.screenScaleMultiplier).toFixed(7)} : x`,\n            )}\n          </animated.span>\n          <br />\n          <animated.span>\n            {props.mandelbrot.interpolate(\n              // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n              (x, y) => `${(y * props.screenScaleMultiplier).toFixed(7)} : y`,\n            )}\n          </animated.span>\n        </Typography>\n      </Card>\n    </Grow>\n  );\n};\n\nexport default CoordinatesCard;\n\n// <Card\n//   style={{\n//     width: 'auto',\n//     position: 'absolute',\n//     zIndex: 2,\n//     right: 0,\n//     top: 0,\n//     margin: 20,\n//     padding: 8,\n//     display: settings.coords[0] ? 'block' : 'none',\n//     // borderRadius: 100,\n//   }}\n// >\n//   <Typography align=\"right\">\n//     {/* https://www.typescriptlang.org/docs/handbook/basic-types.html#tuple */}\n//     {/* https://www.typescriptlang.org/docs/handbook/2/objects.html#tuple-types */}\n//     <animated.span>\n//       {mandelbrotControls.xyCtrl[0].xy.interpolate(\n//         // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n//         (x, y) => `${(x * screenScaleMultiplier).toFixed(7)} : x`,\n//       )}\n//     </animated.span>\n//     <br />\n//     <animated.span>\n//       {mandelbrotControls.xyCtrl[0].xy.interpolate(\n//         // @ts-expect-error: Function call broken in TS, waiting till react-spring v9 to fix\n//         (x, y) => `${(y * screenScaleMultiplier).toFixed(7)} : y`,\n//       )}\n//     </animated.span>\n//   </Typography>\n// </Card>;\n","import { Box, Button, Card, Grow, TextField } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport { ChangeCoordinatesCardProps } from '../../common/info';\nimport {\n  resetPosSpringConfig,\n  resetZoomSpringConfig,\n  startPos,\n  startZoom,\n} from '../../App';\nimport { vScale } from 'vec-la-fp';\n\nconst ChangeCoordinatesCard = (props: ChangeCoordinatesCardProps): JSX.Element => {\n  const [x, setX] = useState(startPos[0]);\n  const [y, setY] = useState(startPos[1]);\n  const [zoom, setZoom] = useState(startZoom);\n\n  const go = () => {\n    props.mandelbrot.xyCtrl[1]({\n      xy: vScale(1 / props.screenScaleMultiplier, [x, y]),\n      config: resetPosSpringConfig,\n    });\n    props.mandelbrot.zoomCtrl[1]({\n      zoom: zoom,\n      config: resetZoomSpringConfig,\n    });\n  };\n\n  return (\n    <Grow in={props.show}>\n      <Card\n        style={{\n          width: 'auto',\n          zIndex: 1300,\n          position: 'relative',\n          padding: 8,\n          display: 'flex',\n          flexDirection: 'column',\n          flexShrink: 1,\n          // display: props.show ? 'block' : 'none',\n          // borderRadius: 100,\n        }}\n      >\n        <Box>\n          <TextField\n            size=\"small\"\n            style={{ width: 100 }}\n            onChange={(e) => setX(Number(e.target.value))}\n            value={x}\n            label=\"x\"\n          />\n        </Box>\n        <Box>\n          <TextField\n            size=\"small\"\n            style={{ width: 100 }}\n            onChange={(e) => setY(Number(e.target.value))}\n            value={y}\n            label=\"y\"\n          />\n        </Box>\n        <Box>\n          <TextField\n            size=\"small\"\n            style={{ width: 100 }}\n            onChange={(e) => setZoom(Number(e.target.value))}\n            value={zoom}\n            label=\"zoom\"\n          />\n        </Box>\n        <Button style={{ marginTop: 12 }} onClick={() => go()}>\n          Go\n        </Button>\n      </Card>\n    </Grow>\n  );\n};\n\nexport default ChangeCoordinatesCard;\n","import React, { useState } from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\nimport MuiDialogContent from '@material-ui/core/DialogContent';\nimport MuiDialogActions from '@material-ui/core/DialogActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport Typography from '@material-ui/core/Typography';\nimport {\n  Link,\n  TableContainer,\n  Table,\n  Paper,\n  TableRow,\n  TableCell,\n  TableHead,\n  TableBody,\n  Box,\n  Divider,\n  Snackbar,\n} from '@material-ui/core';\nimport LaunchIcon from '@material-ui/icons/Launch';\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport { surveyLink } from '../surveyLink.json';\n\n// for evaluating build time\nimport preval from 'preval.macro';\n\nconst dateTimeStamp = preval`module.exports = new Date();`;\n\nconst styles = (theme) => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(2),\n    display: 'flex',\n    flexDirection: 'row',\n    // align: \"middle\",\n  },\n  image: {\n    marginTop: 'auto',\n    marginBottom: 'auto',\n    marginRight: 8,\n    height: 50,\n  },\n  closeButton: {\n    // position: 'absolute',\n    // right: theme.spacing(1),\n    // top: theme.spacing(1),\n    marginLeft: 'auto',\n    color: theme.palette.grey[500],\n  },\n});\n\nconst DialogTitle = withStyles(styles)((props) => {\n  const { children, classes, onClose, ...other } = props;\n  return (\n    <MuiDialogTitle disableTypography className={classes.root} {...other}>\n      <img src=\"logo-512.png\" alt=\"Mandelbrot Maps logo\" className={classes.image} />\n      <Typography\n        variant=\"h1\"\n        style={{ fontSize: 24, marginTop: 'auto', marginBottom: 'auto' }}\n      >\n        {children}\n      </Typography>\n      {onClose ? (\n        <IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      ) : null}\n    </MuiDialogTitle>\n  );\n});\n\nconst DialogContent = withStyles((theme) => ({\n  root: {\n    padding: theme.spacing(3),\n  },\n}))(MuiDialogContent);\n\nconst DialogActions = withStyles((theme) => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1),\n  },\n}))(MuiDialogActions);\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nexport default function InfoDialog(props) {\n  const [open, setOpen] = props.ctrl;\n  const [snackBarOpen, setSnackBarOpen] = useState(false);\n\n  const handleClose = () => setOpen(false);\n\n  // guard against null / undefined window\n  const clientData = window.jscd || {};\n\n  let writeToClipboard = (data) => {\n    try {\n      navigator.clipboard.writeText(data);\n      setSnackBarOpen(true);\n    } catch (e) {\n      window.prompt('Auto copy to clipboard failed, copy manually from below:', data);\n    }\n  };\n\n  return (\n    <Dialog\n      onClose={handleClose}\n      aria-labelledby=\"customized-dialog-title\"\n      open={open}\n      maxWidth=\"md\"\n    >\n      {/* <div style={{ maxWidth: 700 }}> */}\n      <DialogTitle id=\"customized-dialog-title\" onClose={handleClose}>\n        Mandelbrot Maps\n      </DialogTitle>\n      <DialogContent dividers style={{ maxWidth: 700 }}>\n        <Typography gutterBottom>\n          Mandelbrot Maps is an interactive fractal explorer built using React and WebGL.\n        </Typography>\n        <Typography gutterBottom>\n          Developed by{' '}\n          <Link href=\"https://jmaio.github.io/\" target=\"_blank\">\n            Joao Maio\n          </Link>{' '}\n          in 2019/2020 as part of an Honours Project at The University of Edinburgh, under\n          the supervision of Philip Wadler.\n        </Typography>\n        <Typography gutterBottom>\n          The project was simultaneously undertaken by Freddie Bawden, also under the\n          supervision of Philip Wadler. Freddie's version of the project is available at:{' '}\n          <Link href=\"http://mmaps.freddiejbawden.com/\" target=\"_blank\">\n            mmaps.freddiejbawden.com\n          </Link>\n        </Typography>\n        <Typography gutterBottom>\n          The{' '}\n          <Link\n            href=\"https://homepages.inf.ed.ac.uk/wadler/mandelbrot-maps/index.html\"\n            target=\"_blank\"\n          >\n            original Mandelbrot Maps project\n          </Link>{' '}\n          was developed by Iain Parris in 2008 as a Java Applet.\n        </Typography>\n        <Typography gutterBottom>\n          Mandelbrot set shader code adapted from{' '}\n          <Link href=\"https://www.shadertoy.com/view/4df3Rn\">Mandelbrot - smooth</Link> by{' '}\n          <Link href=\"http://iquilezles.org/\" target=\"_blank\">\n            Inigo Quilez\n          </Link>\n          .\n        </Typography>\n        {/* <Typography>\n            &copy; Joao Maio 2020\n          </Typography> */}\n\n        <Divider style={{ marginTop: 30, marginBottom: 30 }} />\n\n        <Box style={{ display: 'flex' }}>\n          <TableContainer\n            component={Paper}\n            style={{ width: 'auto', margin: 'auto', maxWidth: 460 }}\n          >\n            <Table size=\"small\" aria-label=\"a dense table\">\n              <TableHead>\n                <TableRow>\n                  <TableCell align=\"center\" colSpan={2} variant=\"head\">\n                    Device properties\n                  </TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {Object.entries(clientData).map(([k, v]) => (\n                  <TableRow key={k}>\n                    <TableCell>{k}</TableCell>\n                    <TableCell align=\"right\" style={{ fontFamily: 'monospace' }}>\n                      {String(v)}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </TableContainer>\n        </Box>\n\n        <Divider style={{ marginTop: 30, marginBottom: 30 }} />\n\n        <Box style={{ display: 'flex' }}>\n          <Typography variant=\"overline\" align=\"center\" style={{ margin: 'auto' }}>\n            Build:\n            <Typography style={{ fontFamily: 'monospace' }}>{dateTimeStamp}</Typography>\n            {/* {console.log(new Date(dateTimeStamp).toLocaleString('en-GB', { timeZone: 'UTC' }))} */}\n          </Typography>\n        </Box>\n      </DialogContent>\n\n      <DialogActions>\n        <Button\n          onClick={() => {\n            writeToClipboard(JSON.stringify(clientData));\n          }}\n          color=\"primary\"\n          variant=\"outlined\"\n          startIcon={<FileCopyIcon />}\n        >\n          Copy\n        </Button>\n        <Snackbar\n          open={snackBarOpen}\n          autoHideDuration={5000}\n          onClose={() => setSnackBarOpen(false)}\n        >\n          <Alert onClose={() => setSnackBarOpen(false)} severity=\"info\">\n            Device properties copied!\n          </Alert>\n        </Snackbar>\n        <Button\n          autoFocus\n          href={surveyLink}\n          target=\"_blank\"\n          color=\"primary\"\n          variant=\"outlined\"\n          startIcon={<LaunchIcon />}\n        >\n          Feedback\n        </Button>\n      </DialogActions>\n      {/* </div> */}\n    </Dialog>\n  );\n}\n","// TODO set max iterations as parameter\n\nconst newSmoothJuliaShader = ({\n  maxI = 300,\n  AA = 1,\n  B = 64,\n  // crosshair = {\n  //     stroke: 0,\n  //     radius: 0\n  // },\n}) => `\n\n#define AA ${AA}\n#define MAXI ${maxI}\n#define B ${B.toFixed(1)}\n\n// set high float precision (lower than this may break colours on mobile)\nprecision highp float;\n\n// need to know the resolution of the canvas\nuniform vec2 resolution;\n\n// properties should be passed as uniforms\nuniform int   u_maxI;\nuniform vec2  u_xy;\nuniform vec2  u_c;\nuniform float u_zoom;\nuniform float u_theta;\n\nfloat julia( vec2 z, vec2 c ) {\n\n  float l = 0.0;\n  for( int i=0; i<MAXI; i++ )\n  {\n      z = vec2( z.x*z.x - z.y*z.y, 2.0*z.x*z.y ) + c;\n      if( dot(z,z)>(B*B) ) break;\n      l += 1.0;\n  }\n\n  // maxed out iterations\n  if( l>float(MAXI)-1.0 ) return 0.0;\n\n  // equivalent optimized smooth interation count\n  l = l - log2(log2(dot(z,z))) + 4.0;\n\n  return l;\n}\n\nvoid main() {    \n  // set the initial colour to black\n  vec3 col = vec3(0.0);\n\n  // anti-aliasing\n  #if AA>1\n  for( int m=0; m<AA; m++ )\n  for( int n=0; n<AA; n++ )\n  {\n      vec2 p = (2.0*(gl_FragCoord.xy + vec2(float(m), float(n)) / float(AA) ) - resolution.xy)/resolution.y;\n      float w = float(AA*m+n);\n  #else    \n      // adjust pixels to range from [-1, 1]\n      vec2 p = (2.0*gl_FragCoord.xy - resolution.xy)/resolution.y;\n  #endif\n  \n  // constant \"c\" to add, based on mandelbrot position\n  vec2 c = u_c;\n  vec2 z = u_xy + p/u_zoom;\n\n  float l = julia(z, c);\n  col += 0.5 + 0.5*cos( 3.0 + l*0.15 + vec3(0.0,0.6,1.0));\n\n  // antialiasing\n  #if AA>1\n  }\n  col /= float(AA*AA);\n  #endif\n\n  // Output to screen\n  gl_FragColor = vec4( col, 1.0 );\n}\n`;\n\nexport default newSmoothJuliaShader;\n","import { colors, createMuiTheme } from '@material-ui/core';\n\nconst theme = createMuiTheme({\n  props: {\n    // Name of the component ‚öõÔ∏è\n    MuiSwitch: {\n      // The default props to change\n      color: 'primary', // x, on the whole application üí£!\n    },\n    MuiButton: {\n      variant: 'outlined',\n    },\n  },\n  palette: {\n    primary: {\n      main: colors.blue[700],\n    },\n    secondary: {\n      main: colors.red[700],\n    },\n    info: {\n      main: colors.blue[700],\n    },\n  },\n});\n\nexport const simpleBoxShadow = '0px 2px 10px 1px rgba(0, 0, 0, 0.4)';\n\nexport default theme;\n","export const fullVertexShader = `\r\nattribute vec4 position;\r\n\r\nvoid main() {\r\n  gl_Position = position;\r\n}\r\n`;\r\n\r\n// This \"position\" array specifies the vertex positions of the element\r\n// to be displayed by the vertex shader. It represents two triangles,\r\n// each filling half of the screen diagonally, and together filling the\r\n// full canvas space to allow the fragment shader to act on the full canvas.\r\nexport const fullscreenVertexArray = {\r\n  position: {\r\n    numComponents: 3,\r\n    data: [-1, -1, 0, 1, -1, 0, -1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, 0],\r\n  },\r\n};\r\n","import React, { useCallback, useEffect, useRef } from 'react';\r\nimport { animated } from 'react-spring';\r\nimport * as twgl from 'twgl.js';\r\nimport { vScale } from 'vec-la-fp';\r\nimport { WebGLCanvasProps } from '../../common/render';\r\nimport { fullscreenVertexArray, fullVertexShader } from '../../shaders/fullVertexShader';\r\n\r\n// https://mariusschulz.com/blog/typing-destructured-object-parameters-in-typescript\r\n// https://stackoverflow.com/a/50294843/9184658\r\nconst WebGLCanvas = React.forwardRef<\r\n  HTMLCanvasElement,\r\n  WebGLCanvasProps & { mini: boolean }\r\n>((props, refAny) => {\r\n  // const { mini = false, ...rest } = props;\r\n  // props:\r\n  // id\r\n  // fragShader\r\n  // -- uniforms:\r\n  //    u_zoom\r\n  //    u_pos\r\n  //    u_maxI\r\n  // ref\r\n  // glRef\r\n\r\n  const ref = refAny as React.MutableRefObject<HTMLCanvasElement>;\r\n\r\n  // variables to hold canvas and webgl information\r\n  const gl = props.glRef;\r\n  const renderRequestRef = useRef<number>();\r\n  const bufferInfo = useRef<twgl.BufferInfo>();\r\n  const programInfo = useRef<twgl.ProgramInfo>();\r\n\r\n  const u = props.u;\r\n  const setFps = props.fps;\r\n\r\n  // have a zoom callback\r\n  const zoom = props.mini ? () => 1.0 : () => props.u.zoom.getValue();\r\n  const currZoom = useRef(zoom());\r\n\r\n  const dpr = props.useDPR ? window.devicePixelRatio : 1;\r\n\r\n  // useEffect(() => {\r\n  //   console.log(props.cursor?.getValue());\r\n  // });\r\n\r\n  // initial context-getter\r\n  useEffect(() => {\r\n    // console.log(gl);\r\n    // console.log(gl.current);\r\n    gl.current = (ref as React.MutableRefObject<HTMLCanvasElement>).current.getContext(\r\n      'webgl',\r\n    ) as WebGLRenderingContext;\r\n    // console.log(`got canvas context: ${gl.current}`);\r\n    bufferInfo.current = twgl.createBufferInfoFromArrays(\r\n      gl.current as WebGLRenderingContext,\r\n      fullscreenVertexArray,\r\n    );\r\n  }, [gl, ref]);\r\n\r\n  useEffect(() => {\r\n    currZoom.current = props.u.zoom.getValue();\r\n  }, [props.u]);\r\n\r\n  // re-compile program if shader changes\r\n  useEffect(() => {\r\n    programInfo.current = twgl.createProgramInfo(gl.current, [\r\n      fullVertexShader,\r\n      props.fragShader,\r\n    ]);\r\n  }, [gl, props.fragShader]);\r\n\r\n  const then = useRef(0);\r\n  const frames = useRef(0);\r\n  const elapsedTime = useRef(0);\r\n  // fps update interval\r\n  const interval = 1000;\r\n  // const mult = 1000 / interval;\r\n  // the main render function for WebGL\r\n  const render = useCallback(\r\n    (time) => {\r\n      twgl.resizeCanvasToDisplaySize(\r\n        (ref as React.MutableRefObject<HTMLCanvasElement>).current,\r\n        dpr,\r\n      );\r\n      gl.current.viewport(0, 0, gl.current.canvas.width, gl.current.canvas.height);\r\n\r\n      const uniforms = {\r\n        resolution: [gl.current.canvas.width, gl.current.canvas.height],\r\n        u_zoom: zoom(),\r\n        u_c:\r\n          u.c === undefined ? 0 : u.c.getValue().map((x) => x * u.screenScaleMultiplier),\r\n        u_xy: vScale(u.screenScaleMultiplier, u.xy.getValue()),\r\n        u_maxI: u.maxI,\r\n      };\r\n\r\n      gl.current.useProgram((programInfo.current as twgl.ProgramInfo).program);\r\n      twgl.setBuffersAndAttributes(\r\n        gl.current,\r\n        programInfo.current as twgl.ProgramInfo,\r\n        bufferInfo.current as twgl.BufferInfo,\r\n      );\r\n      twgl.setUniforms(programInfo.current as twgl.ProgramInfo, uniforms);\r\n      twgl.drawBufferInfo(gl.current, bufferInfo.current as twgl.BufferInfo);\r\n\r\n      // calculate fps\r\n      if (setFps !== undefined) {\r\n        frames.current++;\r\n        elapsedTime.current += time - then.current;\r\n        then.current = time;\r\n\r\n        // console.log(elapsedTime.current);\r\n        if (elapsedTime.current >= interval) {\r\n          //multiply with (1000 / elapsed) for accuracy\r\n          setFps((frames.current * (interval / elapsedTime.current)).toFixed(1));\r\n          frames.current = 0;\r\n          elapsedTime.current -= interval;\r\n\r\n          // document.getElementById('test').innerHTML = fps;\r\n        }\r\n        // time *= 0.001;                      // convert to seconds\r\n        // const deltaTime = time - then.current; // compute time since last frame\r\n        // then.current = time;                // remember time for next frame\r\n        // const fs = 1 / deltaTime;           // compute frames per second\r\n        // console.log(fs);\r\n        // (fs.toFixed(1));  // update fps display\r\n      }\r\n\r\n      // The 'state' will always be the initial value here\r\n      renderRequestRef.current = requestAnimationFrame(render);\r\n    },\r\n    [gl, u, zoom, dpr, setFps, interval, ref],\r\n  );\r\n\r\n  //\r\n  useEffect(() => {\r\n    renderRequestRef.current = requestAnimationFrame(render);\r\n    return () => cancelAnimationFrame(renderRequestRef.current as number);\r\n  }, [render]);\r\n\r\n  return (\r\n    <animated.canvas\r\n      className=\"renderer\"\r\n      ref={refAny}\r\n      style={{\r\n        // cursor should show whether the viewer is being grabbed\r\n        cursor: props.dragging ? 'grabbing' : 'grab',\r\n        // adding style allows direct style override\r\n        ...props.style,\r\n      }}\r\n    />\r\n  );\r\n});\r\n\r\nWebGLCanvas.displayName = 'WebGLCanvas';\r\n\r\nexport default WebGLCanvas;\r\n","import { ButtonBase, Grow } from '@material-ui/core';\nimport React from 'react';\nimport { MinimapViewerProps } from '../../common/render';\nimport { simpleBoxShadow } from '../../theme/theme';\nimport WebGLCanvas from './WebGLCanvas';\n\nconst miniSize = 100;\n// TODO: make square with rounded corners?\nconst borderRadius = 8;\n\nconst MinimapViewer = (props: MinimapViewerProps): JSX.Element => {\n  const { canvasRef, onClick, show, ...rest } = props;\n  return (\n    <Grow in={show}>\n      <ButtonBase\n        style={{\n          position: 'absolute',\n          // make minimap stick out through backdrop\n          zIndex: 1300,\n          margin: '0.5rem',\n          left: 0,\n          bottom: 0,\n          // cursor: 'pointer',\n          height: miniSize,\n          width: miniSize,\n          borderRadius: borderRadius,\n          // border: \"1px solid #000\",\n          boxShadow: simpleBoxShadow,\n          overflow: 'hidden',\n          // opacity: zoom.interpolate((z) => _.clamp(z - 1, 0, 1)),\n          // display: zoom.interpolate((z) => (_.clamp(z - 1, 0, 1) === 0 ? 'none' : 'block')),\n        }}\n        onClick={onClick}\n      >\n        {/* <animated.div */}\n        {/* // \n      // > */}\n        <WebGLCanvas\n          mini={true}\n          ref={canvasRef}\n          {...rest}\n          // setting border radius here stops the canvas clickable area from overflowing\n          // outside the div circle, which would make the clickable area a rectangle\n          style={{\n            borderRadius: borderRadius,\n            // cursor should be \"pointer\" (looks clickable) if this is a minimap,\n            cursor: 'pointer',\n          }}\n        />\n        {/* </animated.div> */}\n      </ButtonBase>\n    </Grow>\n  );\n};\nexport default MinimapViewer;\n","import _ from 'lodash';\nimport { useCallback, useEffect, useState } from 'react';\nimport { addV } from 'react-use-gesture';\nimport { vScale } from 'vec-la-fp';\n\n// https://usehooks.com/useWindowSize/\nexport function useWindowSize() {\n  const isClient = typeof window === 'object';\n\n  const getSize = useCallback(\n    () => ({\n      width: isClient ? window.innerWidth : undefined,\n      height: isClient ? window.innerHeight : undefined,\n    }),\n    [isClient],\n  );\n\n  const [windowSize, setWindowSize] = useState(getSize);\n\n  useEffect(() => {\n    if (!isClient) {\n      // return false;\n      return () => {};\n    }\n\n    function handleResize() {\n      setWindowSize(getSize());\n    }\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [getSize, isClient]); // Empty array ensures that effect is only run on mount and unmount\n\n  return windowSize;\n}\n\n// a touchbind for re-using across renderers\nexport function genericTouchBind({\n  domTarget,\n  posControl,\n  zoomControl,\n  screenScaleMultiplier,\n  gl,\n  setDragging,\n}) {\n  const [{ xy }, setControlXY] = posControl;\n  const [{ zoom, minZoom, maxZoom }, setControlZoom] = zoomControl;\n  return {\n    binds: {\n      // prevent some browser events such as swipe-based navigation or\n      // pinch-based zoom and instead redirect them to this handler\n      onDragStart: ({ event }) => event.preventDefault(),\n      onPinchStart: ({ event }) => event.preventDefault(),\n\n      onPinch: ({\n        vdva: [vd],\n        down,\n        delta: [dx],\n        origin,\n        first,\n        memo = [xy.getValue()],\n        z = zoom.getValue(),\n      }) => {\n        if (first) {\n          let [p] = memo;\n          return [p, origin];\n        }\n        // initial origin access\n        // let [p, initialOrigin] = memo;\n        let newZ = z * (1 + dx * 5e-3);\n        let newZclamp = _.clamp(newZ, minZoom.getValue(), maxZoom.getValue());\n\n        // let realZoom = gl.current.canvas.height * newZclamp * screenScaleMultiplier;\n        // let plotMovement = scale(subV(origin, initialOrigin), -2/realZoom);\n        // let relMove = [plotMovement[0], -plotMovement[1]];\n\n        setControlZoom({\n          zoom: newZclamp,\n          immediate: down,\n          config: {\n            // value needs revising, currently too slow\n            velocity: 10 * vd,\n          },\n        });\n\n        // setControlPos({\n        //   pos: addV(p, relMove),                    // add the displacement to the starting position\n        //   immediate: down,                                  // immediately apply if the gesture is active\n        // });\n\n        return memo;\n      },\n\n      onWheel: ({ movement: [, my], active, z = zoom.getValue() }) => {\n        // x, y obtained from event\n        let newZ = z * (1 - my * (my < 0 ? 3e-4 : 2e-4));\n\n        setControlZoom({\n          zoom: _.clamp(newZ, minZoom.getValue(), maxZoom.getValue()),\n          immediate: active,\n          config: {\n            // velocity: active ? 0 : 10,\n          },\n        });\n\n        return z;\n      },\n\n      onDrag: ({\n        down,\n        movement,\n        velocity,\n        direction,\n        pinching,\n        memo = xy.getValue(),\n      }) => {\n        // let pinch handle movement\n        if (pinching) return;\n        // change according to this formula:\n        // move (x, y) in the opposite direction of drag (pan with cursor)\n        // divide by canvas size to scale appropriately\n        // multiply by 2 to correct scaling on viewport\n        // use screen multiplier for more granularity\n        let realZoom = gl.current.canvas.height * zoom.getValue() * screenScaleMultiplier;\n\n        let plotMovement = vScale(-2 / realZoom, movement);\n\n        let relMove = [plotMovement[0], -plotMovement[1]];\n        let relDir = [direction[0], -direction[1]];\n\n        setControlXY({\n          xy: addV(memo, relMove), // add the displacement to the starting position\n          immediate: down, // immediately apply if the gesture is active\n          config: {\n            velocity: vScale(-velocity / realZoom, relDir), // set the velocity (gesture momentum)\n            decay: true,\n          },\n        });\n\n        // tell the renderer that it's being dragged on\n        setDragging(down);\n        // try {\n        // } catch (e) {}\n\n        return memo;\n      },\n    },\n    config: {\n      eventOptions: { passive: false, capture: false },\n      domTarget: domTarget,\n      // The config object passed to useGesture has drag, wheel, scroll, pinch and move keys\n      // for specific gesture options. See here for more details.\n      // drag: {\n      //   bounds,\n      //   rubberband: true,\n      // }\n    },\n  };\n}\n","import { Slider, Switch } from '@material-ui/core';\nimport React from 'react';\nimport {\n  settingsDefinitionsType,\n  settingsGroupType,\n  settingsWidgetType,\n} from '../../common/settings';\n\nexport const defaultSettings = {\n  showMinimap: true,\n  showCrosshair: true,\n  showCoordinates: true,\n  maxI: 250,\n  showFPS: false,\n  useDPR: false,\n  useAA: false,\n};\n\nexport const settingsWidgets = (\n  settings: settingsDefinitionsType,\n): settingsWidgetType => ({\n  showMinimap: {\n    k: 'showMinimap',\n    label: 'Minimap',\n    checked: settings.showMinimap,\n    control: <Switch />,\n  },\n  showCrosshair: {\n    k: 'showCrosshair',\n    label: 'Crosshair',\n    checked: settings.showCrosshair,\n    control: <Switch />,\n  },\n  showCoordinates: {\n    k: 'showCoordinates',\n    label: 'Show coordinates',\n    checked: settings.showCoordinates,\n    control: <Switch />,\n  },\n  maxI: {\n    k: 'maxI',\n    label: 'Iterations',\n    value: settings.maxI,\n    labelPlacement: 'top',\n    style: {\n      marginLeft: 0,\n      marginRight: 0,\n    },\n    control: (\n      <Slider\n        min={10}\n        max={1000}\n        step={10}\n        valueLabelDisplay=\"auto\"\n        marks={[\n          { value: 10, label: 10 },\n          { value: 250, label: 250 },\n          { value: 500, label: 500 },\n          { value: 750, label: 750 },\n          { value: 1000, label: 1000 },\n        ]}\n      />\n    ),\n  },\n  useDPR: {\n    k: 'useDPR',\n    // https://stackoverflow.com/a/12830454/9184658\n    // // There is a downside that values like 1.5 will give \"1.50\" as the output. A fix suggested by @minitech:\n    // var numb = 1.5;\n    // numb = +numb.toFixed(2);\n    // // Note the plus sign that drops any \"extra\" zeroes at the end.\n    // // It changes the result (which is a string) into a number again (think \"0 + foo\"),\n    // // which means that it uses only as many digits as necessary.\n    label: `Use pixel ratio (${+window.devicePixelRatio.toFixed(3)})`,\n    checked: settings.useDPR,\n    control: <Switch />,\n  },\n  useAA: {\n    k: 'useAA',\n    label: `Anti-aliasing (slow)`,\n    checked: settings.useAA,\n    control: <Switch />,\n  },\n  showFPS: {\n    k: 'showFPS',\n    label: `Show FPS`,\n    checked: settings.showFPS,\n    control: <Switch />,\n  },\n});\n\nexport const getSettingsWidgetsGrouping = (\n  settingsWidgets: settingsWidgetType,\n): Array<settingsGroupType> => [\n  {\n    name: 'Interface',\n    widgets: [\n      settingsWidgets.showMinimap,\n      settingsWidgets.showCrosshair,\n      settingsWidgets.showCoordinates,\n    ],\n  },\n  {\n    name: 'Graphics',\n    widgets: [\n      settingsWidgets.maxI,\n      settingsWidgets.useDPR,\n      settingsWidgets.useAA,\n      settingsWidgets.showFPS,\n    ],\n  },\n];\n\nexport default defaultSettings;\n","import React, { createContext, ReactNode, useState } from 'react';\nimport { SettingsContextType, settingsDefinitionsType } from '../../common/settings';\nimport defaultSettings, { settingsWidgets } from './SettingsDefinitions';\n\nexport const SettingsContext = createContext<SettingsContextType>({\n  // provide the context with the default values\n  settings: defaultSettings,\n  // can't set state until it's initialized\n  setSettings: () => {\n    return;\n  },\n  settingsWidgets: settingsWidgets(defaultSettings),\n});\n\n// export const useSettings = (): SettingsContextType => useContext(SettingsContext);\n\nexport const SettingsProvider = ({ children }: { children: ReactNode }): JSX.Element => {\n  // https://reactjs.org/docs/context.html#updating-context-from-a-nested-component\n  // no grouping: all settings are accessible\n  const [settings, setSettings] = useState<settingsDefinitionsType>(defaultSettings);\n\n  return (\n    <SettingsContext.Provider\n      value={{\n        settings,\n        setSettings,\n        settingsWidgets: settingsWidgets(settings),\n      }}\n    >\n      {children}\n    </SettingsContext.Provider>\n  );\n};\n\nexport default SettingsProvider;\n","import React, { useEffect, useRef, useState } from 'react';\nimport { useGesture } from 'react-use-gesture';\nimport newSmoothJuliaShader from '../../shaders/newSmoothJuliaShader';\nimport MinimapViewer from './MinimapViewer';\nimport { genericTouchBind } from '../utils';\nimport WebGLCanvas from './WebGLCanvas';\nimport { SettingsContext } from '../settings/SettingsContext';\n\nexport default function JuliaRenderer(props) {\n  // variables to hold canvas and webgl information\n  const canvasRef = useRef();\n  const miniCanvasRef = useRef();\n\n  const gl = useRef();\n  const miniGl = useRef();\n\n  // this multiplier subdivides the screen space into smaller increments\n  // to allow for velocity calculations to not immediately decay, due to the\n  // otherwise small scale that is being mapped to the screen.\n  const screenScaleMultiplier = props.screenmult;\n\n  // read incoming props\n  const [{ xy }] = props.controls.xyCtrl;\n  // const [{ theta, last_pointer_angle }, setControlRot] = props.controls.rot;\n  const [{ zoom }, setControlZoom] = props.controls.zoomCtrl;\n  const maxI = props.maxI; // -> global\n  const AA = props.useAA ? 2 : 1;\n\n  const fragShader = newSmoothJuliaShader({\n    maxI: maxI,\n    AA: AA,\n    // showCrosshair: false,\n  });\n\n  const miniFragShader = newSmoothJuliaShader({\n    maxI: maxI,\n    AA: 2,\n    // showCrosshair: false,\n  });\n\n  const [dragging, setDragging] = useState(false);\n\n  let gtb = genericTouchBind({\n    domTarget: canvasRef,\n    posControl: props.controls.xyCtrl,\n    zoomControl: props.controls.zoomCtrl,\n    screenScaleMultiplier:\n      screenScaleMultiplier / (props.useDPR ? window.devicePixelRatio : 1),\n    gl: gl,\n    setDragging: setDragging,\n  });\n\n  let touchBind = useGesture(gtb.binds, gtb.config);\n\n  useEffect(touchBind, [touchBind]);\n\n  return (\n    <SettingsContext.Consumer>\n      {({ settings }) => (\n        <div\n          className=\"renderer\"\n          style={{\n            position: 'relative',\n          }}\n        >\n          <WebGLCanvas\n            id=\"julia\"\n            fragShader={fragShader}\n            useDPR={props.useDPR}\n            u={{\n              zoom: zoom,\n              xy: xy,\n              c: props.c,\n              maxI: maxI,\n              screenScaleMultiplier: screenScaleMultiplier,\n            }}\n            ref={canvasRef}\n            glRef={gl}\n            dragging={dragging}\n          />\n          <MinimapViewer\n            fragShader={miniFragShader}\n            useDPR={settings.useDPR}\n            u={{\n              zoom: zoom,\n              xy: xy,\n              maxI: maxI,\n              c: props.c,\n              screenScaleMultiplier: screenScaleMultiplier,\n            }}\n            canvasRef={miniCanvasRef}\n            glRef={miniGl}\n            onClick={() => setControlZoom({ zoom: 1 })}\n            show={settings.showMinimap}\n          />\n        </div>\n      )}\n    </SettingsContext.Consumer>\n  );\n}\n","// TODO set max iterations as parameter, crosshair as parameter\n\nconst makeCrosshair = (stroke, radius) => ({\n  stroke,\n  radius,\n});\n\nexport const standardCrosshair = makeCrosshair(2, 100);\nexport const miniCrosshair = makeCrosshair(1, 30);\n\nconst newSmoothMandelbrotShader = (\n  { maxI = 300, AA = 1, B = 64 },\n  showCrosshair = true,\n  crosshairShape = {\n    stroke: 2,\n    radius: 100,\n  },\n) => {\n  return `\n    // Adapted by Joao Maio/2019, based on work by inigo quilez - iq/2013\n    // License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n    \n    // See here for more information on smooth iteration count:\n    // http://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\n    \n    #define false 0\n    #define true 1\n\n    // render parameters\n    #define AA ${AA}\n    #define MAXI ${maxI}\n    #define B ${B.toFixed(1)}\n    \n    // crosshair parameters\n    #define show_crosshair ${showCrosshair}\n    #define cross_stroke ${crosshairShape.stroke.toFixed(1)}\n    #define cross_radius ${crosshairShape.radius.toFixed(1)}\n    \n    // set high float precision (lower than this may break colours on mobile)\n    precision highp float;\n    \n    // need to know the resolution of the canvas\n    uniform vec2 resolution;\n    \n    // properties should be passed as uniforms\n    uniform int   u_maxI;  \n    uniform vec2  u_xy;\n    uniform float u_zoom;\n    uniform float u_theta;\n\n    bool crosshair( float x, float y ) {\n      float abs_x = abs(2.0*x - resolution.x);\n      float abs_y = abs(2.0*y - resolution.y);\n  \n      return \n      // crosshair in centre of screen\n      (abs_x <= cross_stroke || abs_y <= cross_stroke) &&\n      // crosshair size / \"radius\"\n      (abs_x <= cross_radius && abs_y <= cross_radius);\n    }\n    \n    float mandelbrot( in vec2 c ) {\n        {\n            float c2 = dot(c, c);\n            // skip computation inside M1 - http://iquilezles.org/www/articles/mset_1bulb/mset1bulb.htm\n            if( 256.0*c2*c2 - 96.0*c2 + 32.0*c.x - 3.0 < 0.0 ) return 0.0;\n            // skip computation inside M2 - http://iquilezles.org/www/articles/mset_2bulb/mset2bulb.htm\n            if( 16.0*(c2+2.0*c.x+1.0) - 1.0 < 0.0 ) return 0.0;\n        }\n    \n        float l = 0.0;\n        vec2 z  = vec2(0.0);\n        for( int i=0; i<MAXI; i++ )\n        {\n            z = vec2( z.x*z.x - z.y*z.y, 2.0*z.x*z.y ) + c;\n            if( dot(z,z)>(B*B) ) break;\n            l += 1.0;\n        }\n    \n        // maxed out iterations\n        if( l>float(MAXI)-1.0 ) return 0.0;\n        \n        // optimized smooth interation count\n        l = l - log2(log2(dot(z,z))) + 4.0;\n    \n        return l;\n    }\n    \n    void main() {    \n        // set the initial colour to black\n        vec3 col = vec3(0.0);\n    \n        // anti-aliasing\n        #if AA>1\n        for( int m=0; m<AA; m++ )\n        for( int n=0; n<AA; n++ )\n        {\n            // vec2 p = (-iResolution.xy + 2.0*(fragCoord.xy+vec2(float(m),float(n))/float(AA)))/iResolution.y;\n            vec2 p = (2.0*(gl_FragCoord.xy + vec2(float(m), float(n)) / float(AA) ) - resolution.xy)/resolution.y;\n            float w = float(AA*m+n);\n        #else    \n            // adjust pixels to range from [-1, 1]\n            vec2 p = (2.0*gl_FragCoord.xy - resolution.xy)/resolution.y;\n        #endif\n    \n        // c is based on offset and grid position, z_0 = 0\n        vec2 c = u_xy + p/u_zoom;\n        \n        float l = mandelbrot(c);\n        col += 0.5 + 0.5*cos( 3.0 + l*0.15 + vec3(0.0,0.6,1.0));\n    \n        // antialiasing\n        #if AA>1\n        }\n        col /= float(AA*AA);\n        #endif\n    \n        #if show_crosshair\n        if (crosshair(gl_FragCoord.x, gl_FragCoord.y)) {\n            col = 1. - col;\n        }\n        #endif\n    \n        // Output to screen\n        gl_FragColor = vec4( col, 1.0 );\n    }\n    `;\n};\n\nexport default newSmoothMandelbrotShader;\n","import { Card, Grow } from '@material-ui/core';\nimport React from 'react';\nimport { animated } from 'react-spring';\nimport { FPSCardProps } from '../../common/info';\n\nconst FPSCard = (props: FPSCardProps): JSX.Element => (\n  <Grow in={props.show}>\n    <Card\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        padding: '4px 12px',\n        margin: 6,\n        fontFamily: 'monospace',\n        borderRadius: 100,\n        fontSize: '1.8rem',\n        zIndex: 1300,\n        userSelect: 'none',\n      }}\n    >\n      <animated.div>{props.fps}</animated.div>\n    </Card>\n  </Grow>\n);\n\nexport default FPSCard;\n","import React, { useEffect, useRef, useState } from 'react';\nimport { useGesture } from 'react-use-gesture';\nimport newSmoothMandelbrotShader, {\n  miniCrosshair,\n  standardCrosshair,\n} from '../../shaders/newSmoothMandelbrotShader';\nimport FPSCard from '../info/FPSCard';\nimport { SettingsContext } from '../settings/SettingsContext';\nimport { genericTouchBind } from '../utils';\nimport MinimapViewer from './MinimapViewer';\nimport WebGLCanvas from './WebGLCanvas';\n\nexport default function MandelbrotRenderer(props) {\n  // variables to hold canvas and webgl information\n  const canvasRef = useRef();\n  const miniCanvasRef = useRef();\n\n  const gl = useRef();\n  const miniGl = useRef();\n\n  // this multiplier subdivides the screen space into smaller increments\n  // to allow for velocity calculations to not immediately decay, due to the\n  // otherwise small scale that is being mapped to the screen.\n  const screenScaleMultiplier = props.screenmult; // -> global\n\n  // temporary bounds to prevent excessive panning\n  // eslint-disable-next-line\n  const radialBound = 1;\n  // const relativeRadialBound = radialBound;// / -screenScaleMultiplier;\n\n  // read incoming props\n  const [{ xy }] = props.controls.xyCtrl;\n  // const [{ theta, last_pointer_angle }, setControlRot] = props.controls.rot;\n  const [{ zoom }, setControlZoom] = props.controls.zoomCtrl;\n  const maxI = props.maxI; // -> global\n  const AA = props.useAA ? 2 : 1; // -> global\n\n  const fragShader = newSmoothMandelbrotShader(\n    {\n      maxI: maxI,\n      AA: AA,\n    },\n    props.showCrosshair,\n    standardCrosshair,\n  );\n  const miniFragShader = newSmoothMandelbrotShader(\n    {\n      maxI: maxI,\n      AA: 2,\n    },\n    props.showCrosshair,\n    miniCrosshair,\n  );\n\n  const [dragging, setDragging] = useState(false);\n\n  const gtb = genericTouchBind({\n    domTarget: canvasRef,\n    posControl: props.controls.xyCtrl,\n    zoomControl: props.controls.zoomCtrl,\n    screenScaleMultiplier:\n      screenScaleMultiplier / (props.useDPR ? window.devicePixelRatio : 1), // -> global\n    gl: gl,\n    setDragging: setDragging,\n  });\n\n  const touchBind = useGesture(gtb.binds, gtb.config);\n\n  useEffect(touchBind, [touchBind]);\n\n  const [fps, setFps] = useState(0);\n\n  return (\n    <SettingsContext.Consumer>\n      {({ settings }) => (\n        <div\n          className=\"renderer\"\n          style={{\n            position: 'relative',\n          }}\n        >\n          <FPSCard fps={fps} show={settings.showFPS} />\n\n          <WebGLCanvas\n            id=\"mandelbrot\"\n            fragShader={fragShader}\n            useDPR={settings.useDPR}\n            // touchBind={touchBind}\n            u={{\n              zoom: zoom,\n              xy: xy,\n              maxI: maxI,\n              screenScaleMultiplier: screenScaleMultiplier,\n            }}\n            ref={canvasRef}\n            glRef={gl}\n            fps={setFps}\n            dragging={dragging}\n          />\n\n          <MinimapViewer\n            fragShader={miniFragShader}\n            useDPR={settings.useDPR}\n            u={{\n              zoom: zoom,\n              xy: xy,\n              maxI: maxI,\n              screenScaleMultiplier: screenScaleMultiplier,\n            }}\n            canvasRef={miniCanvasRef}\n            glRef={miniGl}\n            show={settings.showMinimap}\n            onClick={() => setControlZoom({ zoom: 1 })}\n          />\n        </div>\n      )}\n    </SettingsContext.Consumer>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","// https://felixgerschau.com/create-a-pwa-update-notification-with-create-react-app/\n\nimport { Button, Snackbar } from '@material-ui/core';\nimport Alert from '@material-ui/lab/Alert';\nimport React, { FC, useEffect } from 'react';\nimport * as serviceWorker from '../serviceWorker';\n\nconst ServiceWorkerWrapper: FC = () => {\n  const [showReload, setShowReload] = React.useState(false);\n  const [waitingWorker, setWaitingWorker] = React.useState<ServiceWorker | null>(null);\n\n  const onSWUpdate = (registration: ServiceWorkerRegistration) => {\n    console.log('Out of date version detected! Triggering snackbar.');\n    setShowReload(true);\n    setWaitingWorker(registration.waiting);\n  };\n\n  useEffect(() => {\n    console.log('Registering Service Worker for update detection...');\n    serviceWorker.register({ onUpdate: onSWUpdate });\n  }, []);\n\n  const reloadPage = () => {\n    // optional chaining was not working here...\n    // https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html\n    waitingWorker && waitingWorker.postMessage({ type: 'SKIP_WAITING' });\n    setShowReload(false);\n    // reload(b: Boolean) is deprecated\n    window.location.reload();\n  };\n\n  return (\n    <Snackbar open={showReload} anchorOrigin={{ vertical: 'top', horizontal: 'center' }}>\n      <Alert\n        severity=\"info\"\n        action={\n          <Button color=\"inherit\" variant=\"outlined\" size=\"small\" onClick={reloadPage}>\n            Update\n          </Button>\n        }\n      >\n        A new version is available!\n      </Alert>\n    </Snackbar>\n  );\n};\n\nexport default ServiceWorkerWrapper;\n","import {\n  Backdrop,\n  Divider,\n  Fab,\n  FormControlLabel,\n  FormGroup,\n  Grid,\n  makeStyles,\n  Popover,\n  Typography,\n} from '@material-ui/core';\nimport Button from '@material-ui/core/Button';\nimport InfoIcon from '@material-ui/icons/Info';\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport React, { useState } from 'react';\nimport { SettingsMenuProps } from '../../common/settings';\nimport { SettingsContext } from './SettingsContext';\nimport { getSettingsWidgetsGrouping } from './SettingsDefinitions';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    display: 'flex',\n    flexDirection: 'column',\n    zIndex: 2,\n  },\n  button: {\n    padding: '6px 12px',\n    marginTop: 10,\n  },\n  sliderControl: {\n    width: 30,\n  },\n}));\n\nconst GroupDivider = () => <Divider style={{ marginTop: 10, marginBottom: 4 }} />;\nconst GroupTitle = (props: { title: string }) => (\n  <Typography variant=\"overline\" style={{ fontSize: 14, marginBottom: 4 }}>\n    {props.title}\n  </Typography>\n);\n\nexport default function SettingsMenu(props: SettingsMenuProps): JSX.Element {\n  const classes = useStyles();\n\n  const [anchorEl, setAnchorEl] = useState<EventTarget & HTMLButtonElement>();\n\n  // interface BottomButtonProps extends {\n  //   icon: JSX.Element;\n  //   text: string;\n  //   color: 'inherit' | 'default' | 'primary' | 'secondary' | undefined;\n  //   onClick: () => void;\n  // }\n  // const BottomButton = (props: BottomButtonProps) => (\n  //   <Button\n  //     variant=\"outlined\"\n  //     color={props.color}\n  //     aria-controls={props.text.toLowerCase()}\n  //     onClick={() => props.onClick()}\n  //     className={classes.button}\n  //     startIcon={<MyLocationIcon />}\n  //   >\n  //     Reset\n  //   </Button>\n  // );\n\n  const ResetButton = () => (\n    <Button\n      startIcon={<MyLocationIcon />}\n      color=\"secondary\"\n      aria-controls=\"reset\"\n      onClick={() => {\n        props.reset();\n      }}\n      className={classes.button}\n    >\n      Reset\n    </Button>\n  );\n  const AboutButton = () => (\n    <Button\n      startIcon={<InfoIcon />}\n      color=\"primary\"\n      aria-controls=\"about\"\n      onClick={() => {\n        props.toggleInfo();\n        setAnchorEl(undefined);\n      }}\n      className={classes.button}\n    >\n      About\n    </Button>\n  );\n\n  return (\n    <div className={classes.root}>\n      <Fab\n        aria-controls=\"menu\"\n        aria-haspopup=\"true\"\n        aria-label=\"settings\"\n        size=\"small\"\n        onClick={(e) => setAnchorEl(e.currentTarget)}\n        // className={classes.button}\n      >\n        <SettingsIcon />\n      </Fab>\n      <Backdrop open={Boolean(anchorEl)}>\n        <Popover\n          id=\"menu\"\n          anchorEl={anchorEl}\n          keepMounted\n          open={Boolean(anchorEl)}\n          onClose={() => setAnchorEl(undefined)}\n          anchorOrigin={{\n            horizontal: 'right',\n            vertical: 'bottom',\n          }}\n          transformOrigin={{\n            vertical: 'bottom',\n            horizontal: 'right',\n          }}\n        >\n          <Grid\n            container\n            direction=\"column\"\n            style={{\n              paddingLeft: '1.5em',\n              paddingRight: '1.5em',\n              paddingTop: '1em',\n              paddingBottom: '1em',\n            }}\n          >\n            <Grid item container alignItems=\"center\" justify=\"space-around\">\n              <Grid item>\n                <Typography variant=\"h1\" style={{ fontSize: 20, padding: 10 }}>\n                  Configuration\n                </Typography>\n              </Grid>\n              {/* <Divider orientation=\"vertical\" flexItem /> */}\n              {/* <Grid item>\n                <IconButton\n                  aria-label=\"info\"\n                  size=\"medium\"\n                  onClick={() => {\n                    // open info panel\n                    props.toggleInfo();\n                    // close popover\n                    setAnchorEl(undefined);\n                  }}\n                >\n                  <InfoIcon fontSize=\"inherit\" />\n                </IconButton>\n              </Grid> */}\n            </Grid>\n            <SettingsContext.Consumer>\n              {({ setSettings, settingsWidgets }) =>\n                getSettingsWidgetsGrouping(settingsWidgets).map((g) => (\n                  <Grid item key={g.name}>\n                    <GroupDivider />\n                    <GroupTitle title={g.name} />\n                    <FormGroup>\n                      {g.widgets.map((widget) => (\n                        <FormControlLabel\n                          key={`${widget.label}-control`}\n                          style={{ userSelect: 'none' }}\n                          {...widget}\n                          onChange={(e, val) => {\n                            console.log(`${widget.k} -> ${val}`);\n                            setSettings((prevState) => ({\n                              ...prevState,\n                              [widget.k]: val,\n                            }));\n                          }}\n                        />\n                      ))}\n                    </FormGroup>\n                  </Grid>\n                ))\n              }\n            </SettingsContext.Consumer>\n\n            <GroupDivider />\n\n            <Grid container direction=\"row\" justify=\"space-between\" alignItems=\"stretch\">\n              <Grid item>\n                <ResetButton />\n              </Grid>\n              <Grid item style={{ width: '0.5rem' }} />\n              <Grid item>\n                <AboutButton />\n              </Grid>\n            </Grid>\n\n            {/* <Button\n              aria-controls=\"reset\"\n              onClick={() => props.reset()}\n              className={classes.button}\n              startIcon={<MyLocationIcon />}\n            >\n              Reset\n            </Button> */}\n            {/* <Grid item xs>\n                <Button\n                  aria-controls=\"reset\"\n                  onClick={() => props.reset()}\n                  className={classes.button}\n                  startIcon={<MyLocationIcon />}\n                >\n                  Reset\n                </Button>\n              </Grid>\n              <Grid item xs>\n                <Button\n                  aria-label=\"info\"\n                  size=\"medium\"\n                  onClick={() => {\n                    // open info panel\n                    props.toggleInfo();\n                    // close popover\n                    setAnchorEl(undefined);\n                  }}\n                  className={classes.button}\n                  startIcon={<InfoIcon />}\n                >\n                  About\n                </Button>\n              </Grid> */}\n          </Grid>\n        </Popover>\n      </Backdrop>\n    </div>\n  );\n}\n","import { Grid, ThemeProvider } from '@material-ui/core';\r\nimport React, { useState } from 'react';\r\nimport { useSpring } from 'react-spring';\r\nimport { vScale } from 'vec-la-fp';\r\nimport './App.css';\r\nimport {\r\n  ViewerRotationControl,\r\n  ViewerXYControl,\r\n  ViewerZoomControl,\r\n} from './common/types';\r\nimport CoordinatesCard from './components/info/CoordinatesCard';\r\nimport ChangeCoordinatesCard from './components/info/ChangeCoordinatesCard';\r\nimport InfoDialog from './components/info/InfoDialog';\r\nimport JuliaRenderer from './components/render/JuliaRenderer';\r\n// import 'typeface-roboto';\r\nimport MandelbrotRenderer from './components/render/MandelbrotRenderer';\r\nimport ServiceWorkerWrapper from './components/ServiceWorkerWrapper';\r\nimport SettingsProvider, { SettingsContext } from './components/settings/SettingsContext';\r\nimport SettingsMenu from './components/settings/SettingsMenu';\r\nimport { useWindowSize } from './components/utils';\r\nimport theme from './theme/theme';\r\n\r\nexport const defaultSpringConfig = { mass: 1, tension: 100, friction: 200 };\r\n\r\nexport const resetPosSpringConfig = { mass: 1, tension: 200, friction: 75 };\r\nexport const resetZoomSpringConfig = { mass: 1, tension: 300, friction: 60 };\r\n\r\nexport const startPos: [number, number] = [-0.7746931, 0.1242266];\r\nexport const startZoom = 85.0;\r\nexport const screenScaleMultiplier = 1e-7;\r\n\r\nfunction App(): JSX.Element {\r\n  const size = useWindowSize();\r\n\r\n  // this multiplier subdivides the screen space into smaller increments\r\n  // to allow for velocity calculations to not immediately decay, due to the\r\n  // otherwise small scale that is being mapped to the screen.\r\n\r\n  // const startPos = [-.7426482, .1271875 ];\r\n  // const startPos = [-0.1251491, -0.8599647];\r\n\r\n  // interface posInterface extends UseSpringBaseProps {\r\n  //   pos: [number, number],\r\n  //   config: SpringConfig,\r\n  // }\r\n\r\n  const mandelbrotControls = {\r\n    xyCtrl: useSpring<ViewerXYControl>(() => ({\r\n      xy: vScale(1 / screenScaleMultiplier, startPos),\r\n      config: defaultSpringConfig,\r\n    })),\r\n\r\n    rotCtrl: useSpring<ViewerRotationControl>(() => ({\r\n      theta: 0,\r\n      // last_pointer_angle: 0,\r\n      // itheta: 0,\r\n      config: defaultSpringConfig,\r\n    })),\r\n\r\n    zoomCtrl: useSpring<ViewerZoomControl>(() => ({\r\n      zoom: startZoom,\r\n      // last_pointer_dist: 0,\r\n\r\n      minZoom: 0.5,\r\n      maxZoom: 100000,\r\n\r\n      config: { mass: 1, tension: 600, friction: 50 },\r\n    })),\r\n  };\r\n\r\n  // const [a] = mandelbrotControls.xyCtrl;\r\n  // typeof a.xy;\r\n\r\n  const juliaControls = {\r\n    xyCtrl: useSpring<ViewerXYControl>(() => ({\r\n      xy: [0, 0] as [number, number],\r\n      config: defaultSpringConfig,\r\n    })),\r\n\r\n    rotCtrl: useSpring<ViewerRotationControl>(() => ({\r\n      theta: 0,\r\n      // last_pointer_angle: 0,\r\n      // itheta: 0,\r\n      config: defaultSpringConfig,\r\n    })),\r\n\r\n    zoomCtrl: useSpring<ViewerZoomControl>(() => ({\r\n      zoom: 0.5,\r\n      // last_pointer_dist: 0,\r\n\r\n      minZoom: 0.5,\r\n      maxZoom: 100000,\r\n\r\n      config: { mass: 1, tension: 600, friction: 50 },\r\n    })),\r\n  };\r\n\r\n  const reset = () => {\r\n    mandelbrotControls.xyCtrl[1]({\r\n      xy: [0, 0],\r\n      config: resetPosSpringConfig,\r\n    });\r\n    mandelbrotControls.zoomCtrl[1]({\r\n      zoom: 1,\r\n      config: resetZoomSpringConfig,\r\n    });\r\n\r\n    juliaControls.xyCtrl[1]({\r\n      xy: [0, 0],\r\n      config: resetPosSpringConfig,\r\n    });\r\n    juliaControls.zoomCtrl[1]({\r\n      zoom: 1,\r\n      config: resetZoomSpringConfig,\r\n    });\r\n  };\r\n\r\n  const [showInfo, setShowInfo] = useState(false);\r\n\r\n  const toggleInfo = () => setShowInfo(!showInfo);\r\n\r\n  // const { settings } = useSettings();\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <ServiceWorkerWrapper />\r\n      <SettingsProvider>\r\n        <Grid container>\r\n          <SettingsContext.Consumer>\r\n            {({ settings }) => (\r\n              <Grid\r\n                item\r\n                container\r\n                direction={\r\n                  (size.width || 1) < (size.height || 0) ? 'column-reverse' : 'row'\r\n                }\r\n                justify=\"center\"\r\n                className=\"fullSize\"\r\n                style={{\r\n                  position: 'absolute',\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    position: 'absolute',\r\n                    right: 0,\r\n                    top: 0,\r\n                    margin: 20,\r\n                    width: 'auto',\r\n                  }}\r\n                >\r\n                  <CoordinatesCard\r\n                    show={settings.showCoordinates}\r\n                    mandelbrot={mandelbrotControls.xyCtrl[0].xy}\r\n                    screenScaleMultiplier={screenScaleMultiplier}\r\n                  />\r\n                  <ChangeCoordinatesCard\r\n                    show={settings.showCoordinates}\r\n                    mandelbrot={mandelbrotControls}\r\n                    screenScaleMultiplier={screenScaleMultiplier}\r\n                  />\r\n                </div>\r\n                <Grid item xs className=\"renderer\">\r\n                  <MandelbrotRenderer\r\n                    controls={mandelbrotControls}\r\n                    screenmult={screenScaleMultiplier}\r\n                    {...settings}\r\n                  />\r\n                </Grid>\r\n                <Grid item xs className=\"renderer\">\r\n                  <JuliaRenderer\r\n                    c={mandelbrotControls.xyCtrl[0].xy}\r\n                    controls={juliaControls}\r\n                    screenmult={screenScaleMultiplier}\r\n                    {...settings}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n            )}\r\n          </SettingsContext.Consumer>\r\n\r\n          <SettingsMenu reset={() => reset()} toggleInfo={() => toggleInfo()} />\r\n\r\n          <InfoDialog ctrl={[showInfo, setShowInfo]} />\r\n        </Grid>\r\n      </SettingsProvider>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.register();\n"],"sourceRoot":""}